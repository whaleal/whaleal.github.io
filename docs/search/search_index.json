{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"DocumentDataTransfer/","title":"Document Data Transfer","text":"<p>whaleal</p>"},{"location":"Support/","title":"Support","text":"<p>whaleal</p>"},{"location":"WhalealData/","title":"Whaleal Data","text":"<p>whaleal</p>"},{"location":"WhalealPlatform/","title":"Index","text":"<p>whaleal</p>"},{"location":"WhalealPlatform/03-Projects/","title":"Projects","text":"<p>All server resources and MongoDB resource management on the platform are based on Project. </p> <p>When new resources are added to the platform, Project must be allocated before they can be operated and managed through the platform. Resources between different Projects are isolated from each other. </p> <p>Server resources and MongoDB resources do not allow resource configuration across projects, but users can manage multiple Projects. </p> <p>All user rights isolation is also based on Project.</p> <p></p> <p>The platform has two projects by default: DDT and public.</p> <ul> <li>DDT: Resource management used for backup processes.</li> <li>public: Used for public resource management. New users are assigned to this Project by default.</li> </ul>"},{"location":"WhalealPlatform/01-WhalealOverview/01-WhalealArchitecture/","title":"Whaleal Architecture","text":"<p>Whaleal Platform (WAP) is an intelligent operation, maintenance and hosting platform that provides real-time monitoring and management of your MongoDB services 7*24 hours a day.</p> <p></p> <p>As an open source MongoDB database monitoring solution, WAP provides instant troubleshooting and diagnostic capabilities to ensure the continued stable operation of your MongoDB database and increase productivity. At the same time, WAP also supports automatic backup and recovery, providing you with comprehensive data protection to ensure data security and reliability. </p> <p>By choosing WAP, you will experience the convenience and efficiency of intelligent operation and maintenance.</p>"},{"location":"WhalealPlatform/01-WhalealOverview/01-WhalealArchitecture/#whaleal-application","title":"Whaleal Application","text":"<p>The Whaleal application provides a user interface and a MongoDB agent for HTTP services to transfer data to and from Whaleal. These are stateless and automatically start when the Whaleal application is launched.</p> <p>By default, the Whaleal Web application runs on port 80, the Whaleal backend interface runs on port 8080, and the Whaleal initialization boot page runs on port 9599.</p> <p>For a list of default ports and health check endpoints for Whaleal, please refer to the firewall configuration.</p>"},{"location":"WhalealPlatform/01-WhalealOverview/01-WhalealArchitecture/#whaleal-backup","title":"Whaleal Backup","text":"<p>Whaleal performs MongoDB database backup through DDT or DUMP.</p> <p>For information on how to start, check status, stop, and restart the MongoDB backup process, refer to Starting and Stopping MongoDB Backup.</p> <p>Regarding DDT's support for MongoDB versions, it covers versions 5.0 - 7.0.</p>"},{"location":"WhalealPlatform/01-WhalealOverview/01-WhalealArchitecture/#dedicated-storage-for-operational-data","title":"Dedicated Storage for Operational Data","text":""},{"location":"WhalealPlatform/01-WhalealOverview/01-WhalealArchitecture/#whaleal-application-database","title":"Whaleal Application Database","text":"<p>Whaleal uses a dedicated MongoDB to store operational data. The application database should run as a replica set to ensure redundancy and high availability. This replica set is only used to store Whaleal data. Before installing Whaleal, you must first install and configure the application database. This database contains metadata for the Whaleal application.</p> <ul> <li> <p>MongoDB monitoring data collected from agents.</p> </li> <li> <p>Metadata for Whaleal users, projects, hosts, monitoring data, and backup data.</p> </li> </ul>"},{"location":"WhalealPlatform/01-WhalealOverview/01-WhalealArchitecture/#snapshot-storage","title":"Snapshot Storage","text":"<p>Whaleal creates deployment snapshots to back up the MongoDB database. You can store these snapshots in snapshot storage. The snapshot store is S3. Each project can have multiple snapshot stores. And Whaleal records the newly generated Oplog into a separate database.</p>"},{"location":"WhalealPlatform/01-WhalealOverview/02-ExampleDeployment/","title":"Example Deployment","text":"<p>Below is a description of deploying Whaleal and MongoDB in different environments.</p>"},{"location":"WhalealPlatform/01-WhalealOverview/02-ExampleDeployment/#test-install-on-a-single-host","title":"Test Install on a Single Host","text":"<p>For a test deployment, you can deploy all of the WAP components to a single host, as described in Install a Simple Test WAP Installation.</p> <p>If you would like to test backup services, use the WAP Application to configure them. When configuring WAP, you can specify the backup settings.</p>"},{"location":"WhalealPlatform/01-WhalealOverview/02-ExampleDeployment/#production-installs","title":"Production Installs","text":""},{"location":"WhalealPlatform/01-WhalealOverview/02-ExampleDeployment/#redundant-metadata-and-snapshots","title":"Redundant Metadata and Snapshots","text":"<p>This deployment provides redundancy for the WAP Application Database and Snapshot Storage in the event of host failure. The deployment runs the database in a MongoDB replica set with three data-bearing members with copies of the data.</p> <p>This deployment provides high availability for the WAP Application. WAP uses a w:2 write concern, and can tolerate the loss of one data-bearing node from the WAP Application Database. To make the deployment more durable, enable journaling.</p> <p>All hosts must satisfy the combined hardware and software requirements for systems specified in the System Requirements column.</p> <p>For an example tutorial on installing the minimally viable Whaleal installation, see QuickStart.</p>"},{"location":"WhalealPlatform/01-WhalealOverview/03-QuickStart/","title":"Quick Start","text":"<p>This setup is not suitable for a production deployment.</p> <p>To evaluate WAP, you can install the WAP Application and WAP Application Database on a single host. This setup provides all the functionality of WAP monitoring and automation but provides no failover or high availability.</p>"},{"location":"WhalealPlatform/01-WhalealOverview/03-QuickStart/#considerations","title":"Considerations","text":"<p>This test installation includes the following caveats:</p> <ul> <li> <p>It uses one mongod for the WAP Application database. In production, the database requires a dedicated replica set.</p> </li> <li> <p>It uses MongoDB Community Edition. MongoDB Community doesn't need additional libraries.</p> </li> </ul>"},{"location":"WhalealPlatform/01-WhalealOverview/03-QuickStart/#procedure","title":"Procedure","text":"<p>To install and configure an evaluation version of WAP on hosts running CentOS Linux release 7.9.2009:</p>"},{"location":"WhalealPlatform/01-WhalealOverview/03-QuickStart/#1-provision-an-wap","title":"1. Provision an WAP.","text":"<p>Provision a host for WAP. This host must meet the following requirements:</p> Parameters Value System Memory 16GB Disk Capacity 500GB Host OS Permissions root Host OS CentOS Linux release 7.9.2009 <p>Cloud-based instances must meet the memory and storage requirements.</p> <p>To verify the needed capacity, log in to the instance and execute the following commands:</p> <pre><code>vmstat -S M -s | grep \"total memory\"\n</code></pre> <p>The output for the command shows that this instance has 16 GB of RAM.</p> <pre><code>16384 M total memory\n</code></pre> <pre><code>df -h | grep \"/$\"\n</code></pre> <p>The output for the command shows that this instance has 557 GB of storage capacity.</p> <pre><code>/dev/sda        557G  1.4G  548G   1% /\n</code></pre> <p>Verify that the <code>ulimit</code> settings meet the minimum requirements.</p>"},{"location":"WhalealPlatform/01-WhalealOverview/03-QuickStart/#2-configure-yum-to-install-mongodb","title":"2. Configure yum to install MongoDB.","text":"<p>Create a <code>/etc/yum.repos.d/mongodb-org-5.0.repo</code> file so that you can install MongoDB directly using <code>yum</code>:</p> <pre><code>[mongodb-org-5.0]\nname=MongoDB Repository\nbaseurl=https://repo.mongodb.org/yum/redhat/$releasever/mongodb-org/5.0/x86_64/\ngpgcheck=1\nenabled=1\ngpgkey=https://pgp.mongodb.com/server-5.0.asc\n</code></pre>"},{"location":"WhalealPlatform/01-WhalealOverview/03-QuickStart/#3-install-mongodb","title":"3. Install MongoDB.","text":"<p>Invoke the following command to install the latest stable release of MongoDB Community:</p> <pre><code>sudo yum install -y mongodb-org\n</code></pre>"},{"location":"WhalealPlatform/01-WhalealOverview/03-QuickStart/#4-optional-disable-the-mongod-service","title":"4. Optional: Disable the mongod service.","text":"<p>WAP connects to its application database on port 27017. If the host on which you want to install the application database has a running mongod, disable that existing database.</p> <p>To disable the mongod service, invoke the following command:</p> <pre><code>sudo systemctl disable mongod\n</code></pre>"},{"location":"WhalealPlatform/01-WhalealOverview/03-QuickStart/#5-create-the-wap-application-database-directory","title":"5. Create the WAP Application Database directory.","text":"<pre><code>sudo mkdir /data/\n</code></pre>"},{"location":"WhalealPlatform/01-WhalealOverview/03-QuickStart/#6-update-the-mongodb-configuration-file","title":"6. Update the MongoDB configuration file.","text":"<p>The installer creates a configuration file saved at <code>/etc/mongod.conf</code>.</p> <p>Edit the file to make the following changes:</p> <pre><code>net:\n  bindIp: 0.0.0.0\n  port: 27017\nprocessManagement:\n  fork: \"true\"\nsecurity:\n  authorization: enabled\n  keyFile: /data/keyfile\nstorage:\n  dbPath: /data\n  journal:\n      enabled: true\n  engine: wiredTiger\n  wiredTiger:\n    engineConfig:\n      cacheSizeGB: 4\nsystemLog:\n  destination: file\n  path: /data/mongodb.log\n  logAppend: true\n</code></pre> <p>Save the file when you have made the edits.</p>"},{"location":"WhalealPlatform/01-WhalealOverview/03-QuickStart/#7-create-the-mongodb-keyfile","title":"7. Create the MongoDB KeyFile.","text":"<pre><code>openssl rand -base64 756 &gt; /data/keyfile\nchmod 400 /data/keyfile\n</code></pre>"},{"location":"WhalealPlatform/01-WhalealOverview/03-QuickStart/#8-start-the-wap-application-database-mongod-instance","title":"8. Start the WAP Application Database mongod instance.","text":"<pre><code>sudo mongod -f /etc/mongod.conf\n</code></pre>"},{"location":"WhalealPlatform/01-WhalealOverview/03-QuickStart/#9-create-user-in-application-database","title":"9. Create User in Application Database.","text":"<pre><code>mongosh\n\nuser admin\ndb.createUser({\"user\": \"root\", \"pwd\": \"123456\", \"roles\": [\"root\"]})\n</code></pre>"},{"location":"WhalealPlatform/01-WhalealOverview/03-QuickStart/#10-prepare-wap-package","title":"10. Prepare WAP Package.","text":"<pre><code>WAP.tar.gz\n</code></pre> <p>\u200b    </p>"},{"location":"WhalealPlatform/01-WhalealOverview/03-QuickStart/#11-start-wap-service","title":"11. Start WAP service.","text":"<pre><code>pkill -9 java\ntar -zxvf WAP.tar.gz -C /opt/\ncd /opt/WAP\n</code></pre> <p>Update the WAP config file <code>/opt/WAP/start.sh</code>:</p> <pre><code># Configure external access IP address\nbind_ip=&lt;public IP&gt;\n# Configure the WAP application database URL. Requires authorization to use the whaleal database\nappDBUrl=mongodb://root:123456@127.0.0.1:27017/admin\n</code></pre> <p>Start WAP service</p> <pre><code>cd /opt/WAP\nchmod +x start.sh\n\n./start.sh\n</code></pre>"},{"location":"WhalealPlatform/01-WhalealOverview/03-QuickStart/#12-open-the-wap-home-page-and-reset-password","title":"12. Open the WAP home page and Reset Password.","text":"<pre><code>http://&lt;public IP&gt;\n\nusername: admin\npassword: password\n</code></pre> <p>Reseted Password and Login</p> <p>\u200b    </p>"},{"location":"WhalealPlatform/01-WhalealOverview/03-QuickStart/#13-set-up-your-first-deployment","title":"13. Set up your first deployment.","text":"<p>a. Click Server/EC2 ADD Host</p> <p>b. Click MongoDB Deployment a Cluster</p>"},{"location":"WhalealPlatform/02-InstallWhaleal/01-InstallationChecklist/","title":"Installation Checklist","text":"<p>You must make several decisions based on the content of this page before you install Whaleal. During the installation process, you will make choices based on these decisions.</p> <p>To install Whaleal:</p> <ol> <li> <p>Read the Whaleal Overview.</p> </li> <li> <p>Plan your installation according to the questions on this page.</p> </li> <li> <p>Provision servers that meet the Whaleal Platform System Requirements.</p> </li> <li> <p>Install the Application Database and optional Backup Database.</p> </li> <li> <p>Install Whaleal.</p> </li> </ol>"},{"location":"WhalealPlatform/02-InstallWhaleal/01-InstallationChecklist/#will-you-deploy-managed-mongodb-instances-on-servers-that-have-no-internet-access","title":"Will you deploy managed MongoDB instances on servers that have no internet access?","text":"<p>If the servers where you deploy MongoDB don\u2019t have internet access and if you use Automation, then before you create the first managed MongoDB deployment from Whaleal, you must configure local mode and store the binaries. Agents can then download the binaries directly from Whaleal. </p>"},{"location":"WhalealPlatform/02-InstallWhaleal/01-InstallationChecklist/#security-decisions","title":"Security Decisions","text":""},{"location":"WhalealPlatform/02-InstallWhaleal/01-InstallationChecklist/#will-you-use-authentication-tls-or-both-for-the-connections-to-the-backing-databases","title":"Will you use authentication, TLS, or both for the connections to the backing databases?","text":"<p>If you will use authentication or TLS for connections to the  Application Database , you must configure those options on each database when deploying the database and then you must configure Whaleal with the necessary certificate information for accessing the databases. </p>"},{"location":"WhalealPlatform/02-InstallWhaleal/02-HardwareAndSoftwareRequirements/","title":"Hardware And Software Requirements","text":"<p>This section describes the hardware, software, and networking requirements for the hosts that run the Whaleal components.</p> <p>Before installing Whaleal Platform (WAP), you need to review the following materials: - Server Requirement - Agent Requirement</p>"},{"location":"WhalealPlatform/02-InstallWhaleal/02-HardwareAndSoftwareRequirements/#server-requirement","title":"Server Requirement","text":""},{"location":"WhalealPlatform/02-InstallWhaleal/02-HardwareAndSoftwareRequirements/#hardware-requirement","title":"Hardware Requirement","text":"<p>All hosts that install the following Whaleal Platform (WAP) components must meet RAM and Disk requirements:</p> <ul> <li>Whaleal Platform Application</li> <li>Whaleal Platform Application Databases</li> </ul> <p>Whaleal Platform Application Hardware Requirement</p> <p>All hosts deploying Whaleal Platform Application must meet the following hardware requirements:</p> Number of Monitored Nodes CPU Memory Disk 50 8+ 8GB+ 200GB + logs storage 200 16+ 16GB+ 500GB + logs storage 200+ Contact Whaleal Team Contact Whaleal Team Contact Whaleal Team <p>Whaleal Platform Application Database Hardware Requirement</p> <p>All hosts deploying Whaleal Platform Application Database must meet the following hardware requirements:</p> Number of Monitored Nodes CPU Memory Disk 50 4+ 8GB+ 200GB 200 8+ 16GB+ 500GB 200+ Contact Whaleal Team Contact Whaleal Team Contact Whaleal Team <p>For better performance, it is recommended to use:</p> <ul> <li>SSD for Application Database storage</li> <li>WiredTiger storage engine for Application Database</li> </ul>"},{"location":"WhalealPlatform/02-InstallWhaleal/02-HardwareAndSoftwareRequirements/#software-requirement","title":"Software Requirement","text":"<p>Java Environment Requirement</p> JAVA Version jdk 11+ open-jdk 11+ <p>Operating System Compatibility</p> <p>Whaleal Platform Application must be deployed on a 64-bit operating system.</p> Operating System Version Red Hat Enterprise Linux 6.x, 7.x, 8.x CentOS 6.x, 7.x, 8.x"},{"location":"WhalealPlatform/02-InstallWhaleal/02-HardwareAndSoftwareRequirements/#network-security","title":"Network Security","text":"<p>TCP Connection Requirement</p> <p>All Whaleal Platform Application services must be able to communicate properly with the following services:</p> <ul> <li>Whaleal Platform Application Database</li> <li>Whaleal Platform Application Agent Monitor MongoDB</li> </ul> <p>Hosts</p> <p>To facilitate easier usage, it is recommended to configure the hostname of the server where the Whaleal Platform Application is located</p> <p>Port</p> <p>Whaleal Platform Application must meet the following basic requirements:</p> <ul> <li>Users and Whaleal Platform Application Agent must be able to access via HTTP/HTTPS requests</li> <li>Whaleal Platform Application must be able to access Whaleal Platform Application Database</li> <li>All Whaleal Platform Application and Whaleal Platform Application Agent must be able to access the monitored MongoDB services</li> <li>Whaleal Platform Application must be able to send messages to users via email, SMS, and DingTalk</li> </ul> <p>Therefore, Whaleal Platform Application must have the following ports open:</p> Service Default Port Transport Direction Description HTTP 8080 TCP Inbound WAP default service port Boot Page 9599 TCP Inbound WAP login page port Web 80 TCP Inbound WAP Web Port <p>For custom ports, please open the specified ports.</p> <p>Ports on Host</p> <p>Whaleal Platform Application can complete most operations, but some processes require administrator access to the Whaleal Platform Application host to complete. Therefore, the following port must be open:</p> Service Default Port Transport Direction Description ssh 22 TCP Inbound Default port for SSH (Secure Shell) service"},{"location":"WhalealPlatform/02-InstallWhaleal/02-HardwareAndSoftwareRequirements/#agent-requirement","title":"Agent Requirement","text":""},{"location":"WhalealPlatform/02-InstallWhaleal/02-HardwareAndSoftwareRequirements/#hardware-requirement_1","title":"Hardware Requirement","text":"<p>All hosts that install the following Whaleal Platform (WAP) components must meet RAM and Disk requirements:</p> <ul> <li>Whaleal Platform Application Agent</li> </ul> <p>Whaleal Platform Application Agent Hardware Requirement</p> <p>All hosts deploying Whaleal Platform Application Agent must meet the following hardware requirements:</p> Number of Managed/Monitored Nodes CPU Memory Disk 1 1+ 2GB+ 2GB + logs storage 5 2+ 4GB+ 2GB + logs storage 5+ Contact Whaleal Team Contact Whaleal Team Contact Whaleal Team"},{"location":"WhalealPlatform/02-InstallWhaleal/02-HardwareAndSoftwareRequirements/#software-requirement_1","title":"Software Requirement","text":"<p>Java Environment Requirement</p> JAVA Version jdk 11+ open-jdk 11+ <p>Operating System Compatibility</p> <p>Whaleal Platform Application Agent must be deployed on a 64-bit operating system.</p> Operating System Version Red Hat Enterprise Linux 6.x, 7.x, 8.x CentOS 6.x, 7.x, 8.x"},{"location":"WhalealPlatform/02-InstallWhaleal/02-HardwareAndSoftwareRequirements/#network-security_1","title":"Network Security","text":"<p>TCP Connection Requirement</p> <p>All Whaleal Platform Application services must be able to communicate properly with the following services:</p> <ul> <li>Whaleal Platform Application Database</li> <li>Whaleal Platform Application Agent Monitor MongoDB</li> </ul> <p>Hosts</p> <p>To ensure the principle of \"out-of-the-box\" use, Whaleal Platform Application uses the domain name cloud.whaleal.com to provide services externally.</p> <p>All hosts that access Whaleal Platform Application must configure host resolution:</p> <pre><code>Whaleal_Platform_Application_IP cloud.whaleal.com\n</code></pre> <p>Ports on Host</p> <p>Whaleal Platform Application Agent can complete most operations, but some processes require administrator access to the Whaleal Platform Application host to complete. Therefore, the following port must be open:</p> Service Default Port Transport Direction Description ssh 22 TCP Inbound"},{"location":"WhalealPlatform/02-InstallWhaleal/03-InstallWhaleal/01-InstallWhalealInAWSMarketPlace/","title":"Install Whaleal in AWS MarketPlace","text":""},{"location":"WhalealPlatform/02-InstallWhaleal/03-InstallWhaleal/01-InstallWhalealInAWSMarketPlace/#subscription-service","title":"Subscription Service","text":""},{"location":"WhalealPlatform/02-InstallWhaleal/03-InstallWhaleal/01-InstallWhalealInAWSMarketPlace/#whalal-platform","title":"Whalal Platform","text":"<ol> <li> <p>Log in to the AWS console.</p> </li> <li> <p>Search Marketplace in Servers.</p> </li> <li> <p>Click Discover products in the left navigation bar of the marketplace.</p> </li> <li> <p>Search for whaleal in MarketPlace.</p> </li> <li> <p>Find Whalal Platform and subscribe.</p> </li> </ol> <p></p> <ol> <li>Click  Continue  To Subscribe</li> </ol> <p></p> <p>Wait for the progress below to load</p> <p></p> <p>Loading completed</p> <p></p> <ol> <li>View subscription results in Manage subscriptions,when you see the WAP in the image below in Manage subscriptions, your subscription is successful.</li> </ol> <p></p>"},{"location":"WhalealPlatform/02-InstallWhaleal/03-InstallWhaleal/01-InstallWhalealInAWSMarketPlace/#whaleal-platform-agent","title":"Whaleal Platform Agent","text":"<ol> <li> <p>Log in to the AWS console.</p> </li> <li> <p>Search Marketplace in Servers.</p> </li> <li> <p>Click Discover products in the left navigation bar of the marketplace.</p> </li> <li> <p>Search for whaleal in MarketPlace.</p> </li> <li> <p>Find Whalal Platform Agent and subscribe.</p> </li> </ol> <p></p> <ol> <li>Click  Continue  To Subscribe</li> </ol> <p></p> <p>Wait for the progress below to load</p> <p></p> <p>Loading completed</p> <p></p> <ol> <li>View subscription results in Manage subscriptions,when you see the WAP in the image below in Manage subscriptions, your subscription is successful.</li> </ol> <p></p>"},{"location":"WhalealPlatform/02-InstallWhaleal/03-InstallWhaleal/01-InstallWhalealInAWSMarketPlace/#install-appdb-for-wap-service","title":"Install appdb for WAP service","text":"<p>Before building the appdb for the WAP service, refer to the Installation Checklist to set the minimum instance parameter configuration.</p> <ol> <li>Start the instance through the subscribed Whaleal Platform Agent in Manage subscriptions and click lunch new instance below the subscription.</li> </ol> <p></p> <ol> <li> <p>Select region.</p> </li> <li> <p>Select Instance type based on actual business pressure.</p> </li> <li> <p>Select Key pair (login).</p> </li> <li> <p>Select or configure a security group and edit Inbound rules and Outbound rules according to business requirements.</p> </li> <li> <p>Configuring storage space size.</p> </li> <li> <p>Click lunch to start the instance.</p> </li> <li> <p>Access the instance and use the script in the instance to start appdb.</p> </li> </ol> <p>There is a QuickStart_MongoDB.sh script in the /opt directory of the instance. You can directly execute the script to start a mongodb, or use the self-built method to start the mongodb service as the WAP appdb. No matter which method is used to start, ensure that the starting user has sufficient read and write permissions.</p> <p>After starting the script, the following output will be displayed. The content in the red box below is saved locally to prevent loss.</p> <p>Record username and password</p> <p></p> <p>After the modification is completed, test the connection locally</p> <p></p>"},{"location":"WhalealPlatform/02-InstallWhaleal/03-InstallWhaleal/01-InstallWhalealInAWSMarketPlace/#install-wap","title":"Install WAP","text":"<p>Before building  WAP service, refer to the Installation Checklist to set the minimum instance parameter configuration.</p> <ol> <li>Under Manage subscriptions, find Instance new Instance under Whaleal Platform</li> </ol> <p></p> <ol> <li> <p>Select region.</p> </li> <li> <p>Select Instance type based on actual business pressure.</p> </li> <li> <p>Select Key pair (login).</p> </li> <li> <p>Select or configure a security group and edit Inbound rules and Outbound rules according to business requirements.</p> </li> <li> <p>Configuring storage space size.</p> </li> <li> <p>Click lunch to start the instance.</p> </li> </ol>"},{"location":"WhalealPlatform/02-InstallWhaleal/03-InstallWhaleal/01-InstallWhalealInAWSMarketPlace/#configuring-wap","title":"Configuring WAP","text":"<ol> <li>Access its public IP directly in the browser,visit the WAP guide page to configure WAP.</li> </ol> <ol> <li>Click the Next step button and then proceed to resource check.</li> </ol> <p>After all the checks are passed, you can proceed to the next step.</p> <p></p> <ol> <li>Configure appdb and modify the three items Database host, User and Password.After the configuration is complete, click Next step.</li> </ol> <p></p> <ol> <li> <p>Configure Web Url and click Next step.</p> </li> <li> <p>At this point, the configuration is successful and click lunch.</p> </li> </ol> <p>\u200b    As shown below, when all components are successfully started, click Next step</p> <p></p> <ol> <li> <p>Click the Finish</p> </li> <li> <p>First login WAP.</p> </li> </ol> <p>a. The first login the default user name is \"admin\" and the default password is \"password\".</p> <p>b. Change default password after login.</p> <ol> <li>Login to WAP service.</li> </ol> <p></p>"},{"location":"WhalealPlatform/02-InstallWhaleal/03-InstallWhaleal/02-InstallWhalealinDocker/","title":"Install Whaleal in Docker","text":""},{"location":"WhalealPlatform/02-InstallWhaleal/03-InstallWhaleal/03-OnPremiseInstallWhaleal/","title":"OnPremise Install Whaleal","text":""},{"location":"WhalealPlatform/02-InstallWhaleal/03-InstallWhaleal/03-OnPremiseInstallWhaleal/#prerequisites","title":"Prerequisites","text":"<p>You must have administrative access on the hosts to which you install.</p> <p>Before you install Whaleal, you must:</p> <ol> <li> <p>Plan your configuration. See Installation Checklist.</p> </li> <li> <p>Deploy hosts that meet the Whaleal System Requirements.</p> </li> </ol> <p>IMPORTANT</p> <p>Your Whaleal instance can fail in production if you fail to configure the following:</p> <ul> <li>Whaleal hosts per the Whaleal System Requirements.</li> <li>MongoDB hosts per the Production Notes in the MongoDB manual. MongoDB instances in Whaleal include:</li> <li>The Whaleal Application Database,</li> <li>Each blockstore.</li> </ul> <ol> <li>Install the Whaleal Application Database and optional Backup Database. The databases require dedicated MongoDB instances. Don't use MongoDB installations that store other data. Whaleal requires the Backup Database if you use the Backup feature.</li> </ol> <p>The Whaleal Application must authenticate to the backing databases as a MongoDB user with appropriate access.</p>"},{"location":"WhalealPlatform/02-InstallWhaleal/03-InstallWhaleal/03-OnPremiseInstallWhaleal/#install-whaleal","title":"Install Whaleal","text":"<p>To install Whaleal:</p>"},{"location":"WhalealPlatform/02-InstallWhaleal/03-InstallWhaleal/03-OnPremiseInstallWhaleal/#contact-jinmu-company-to-get-the-latest-waptargz-compressed-file","title":"Contact Jinmu Company to get the latest WAP.tar.gz compressed file","text":""},{"location":"WhalealPlatform/02-InstallWhaleal/03-InstallWhaleal/03-OnPremiseInstallWhaleal/#optional-verify-whaleal-package-integrity","title":"Optional: Verify Whaleal package integrity.","text":""},{"location":"WhalealPlatform/02-InstallWhaleal/03-InstallWhaleal/03-OnPremiseInstallWhaleal/#install-the-whaleal-package-on-each-server-being-used-for-whaleal","title":"Install the Whaleal package on each server being used for Whaleal.","text":"<p>Navigate to the directory to which to install Whaleal. Extract the archive to that directory:</p> <pre><code>tar -zxf WAP.tar.gz\n</code></pre> <p>When complete,W is installed.</p>"},{"location":"WhalealPlatform/02-InstallWhaleal/03-InstallWhaleal/03-OnPremiseInstallWhaleal/#configure-the-whaleal-connection-to-the-whaleal-application-database","title":"Configure the Whaleal connection to the Whaleal Application Database.","text":"<p>On a server that is to run Whaleal, open <code>WAP/start.sh</code> with root privileges and configure the settings described here, as appropriate.</p> <p>Configure the following setting to provide the connection string Whaleal uses to connect to the database:</p> <ul> <li>appDBUrl</li> </ul> <p>Specify the IP address for Whaleal's external access by configuring bind_ip.</p> <ul> <li>bind_ip</li> </ul>"},{"location":"WhalealPlatform/02-InstallWhaleal/03-InstallWhaleal/03-OnPremiseInstallWhaleal/#start-whaleal","title":"Start Whaleal.","text":"<p>Issue the following command:</p> <pre><code>sh WAP/start.sh\n</code></pre>"},{"location":"WhalealPlatform/02-InstallWhaleal/03-InstallWhaleal/03-OnPremiseInstallWhaleal/#open-the-whaleal-home-page-and-register-the-first-user","title":"Open the Whaleal home page and register the first user.","text":"<ol> <li>Enter the following URL in a browser, where <code>&lt;host&gt;</code> is the fully qualified domain name of the server:</li> </ol> <p><code>http://&lt;bind_ip&gt;:8080</code></p> <ol> <li>Use the default username and password for the first login. The default username is: admin, the default password is: password</li> </ol>"},{"location":"WhalealPlatform/02-InstallWhaleal/03-InstallWhaleal/03-OnPremiseInstallWhaleal/#at-this-point-whaleal-has-been-built-and-is-ready-for-use","title":"At this point, Whaleal has been built and is ready for use.","text":""},{"location":"WhalealPlatform/02-InstallWhaleal/03-InstallWhaleal/03-OnPremiseInstallWhaleal/#steps-for-usage","title":"Steps for usage","text":"<ol> <li> <p>Click the Server button in the left navigation bar to jump to the server page.</p> </li> <li> <p>Click the EC2 button in the drop-down box to jump to the Host List page.</p> </li> <li> <p>Click ADD Host to add a server.</p> </li> </ol> <p></p> <p>Now that the server is available, you can use Whaleal to work.</p> <p>For deployment of Standalone, please refer to Deploy a Standalone.</p> <p>For  deployment of Replica Set, please refer to Deploy a Replica Set.</p> <p>For deployment of Sharding Cluster, please refer to Deploy a Sharded Cluster.</p> <p>To use Whaleal to manage an existing cluster, please refer to Deploy a existing Cluster.</p>"},{"location":"WhalealPlatform/03-Projects/01-Projects/","title":"Projects","text":"<p>In WAP, MongoDB deployments are associated with projects.</p> <p>Each project has its own Monitoring, Backup and Automations associated with the project.</p>"},{"location":"WhalealPlatform/03-Projects/01-Projects/#working-with-multiple-environments","title":"Working with Multiple Environments","text":"<p>For a project, the Monitoring must be able to connect to all hosts it monitors. If you have multiple MongoDB deployments in distinct environments and cannot monitor all deployments with a single agent (for instance, if your environments are separated by firewalls), you will need to add new projects.</p> <p>You can also use multiple projects and agents if you want to separately monitor different MongoDB deployments that run in the same environment.</p>"},{"location":"WhalealPlatform/03-Projects/01-Projects/#create-one-project","title":"Create One Project","text":"<p>IMPORTANT</p> <ul> <li>To create a Project, you must proactively add users to the Project.</li> <li>When you create a project, WAP automatically assigns a set of default alert configurations to the project.</li> </ul>"},{"location":"WhalealPlatform/03-Projects/01-Projects/#navigate-to-the-create-a-project-page","title":"Navigate to the Create a Project page.","text":"<ol> <li>Click the Project icon in the upper left corner of the page.</li> <li>Click New Project.</li> </ol>"},{"location":"WhalealPlatform/03-Projects/01-Projects/#provide-a-name-for-your-project","title":"Provide a name for your Project.","text":"Server Intention Project Purpose Production Server Hosts your application to your internal or external end users. If an end user might use an environment, it functions as a Production environment. This applies whether the environment also provides testing, quality assurance, evaluation, or development capabilities. Test/QA Server This type of environment can be used to:Test\uff1aExercises your application to verify that it works as designed and expected. The platform configuration might be a less performant version of Production in compute, network, and storage capability.Assure system quality\uff1aValidates your application against a combination of data, hardware, and software configured to simulate Production. The platform configuration should be a smaller scale of Production in compute, network, and storage capability.Stage\uff1aSimulates the Production environment including performance testing and release candidate approval. The platform configuration should mirror Production in compute, network, and storage capability. Development Server Hosts in progress design, code, debugging or some combination thereof for your application. Used to evaluate if the current state of your application can be promoted to another environment. RAM Pool Provides any combination of servers for any environment purpose."},{"location":"WhalealPlatform/03-Projects/01-Projects/#add-members-to-your-project","title":"Add members to your project.","text":"<p>Select the users who want to join the Project, and finally Confirm.</p>"},{"location":"WhalealPlatform/03-Projects/01-Projects/#delete-one-project","title":"Delete One Project","text":"<p>IMPORTANT</p> <p>After deleting Project, the hosts and MongoDB in this Project will not belong to any Project, and will not be viewable by users in the host list and MongoDB list. If you need to be seen again, you need to grant the user the Write permission in Admin/Account.</p> <p></p> <p></p>"},{"location":"WhalealPlatform/03-Projects/01-Projects/#view-all-of-your-projects","title":"View all of your projects.","text":"<p>\u200b   Click the Project icon in the upper left corner of the page. </p>"},{"location":"WhalealPlatform/03-Projects/01-Projects/#delete-the-project","title":"Delete the project.","text":"<p>\u200b   Click the Project card to display Project details, and click Delete.</p>"},{"location":"WhalealPlatform/04-CreateDeployment/01-DeploymentPrerequisites/","title":"Deployment Prerequisites","text":""},{"location":"WhalealPlatform/04-CreateDeployment/01-DeploymentPrerequisites/#system-requirements","title":"System Requirements","text":""},{"location":"WhalealPlatform/04-CreateDeployment/01-DeploymentPrerequisites/#hardware-and-software","title":"Hardware and Software","text":"<p>Each host must meet the following requirements.</p> <ul> <li>At least 10 GB of free disk space plus whatever space is necessary to hold your MongoDB data.</li> <li>At least 2 GB of RAM.</li> <li>If you use AWS EC2 instances, you should use a minimum of an <code>t3.small</code> instance.</li> <li>The MongoDB Agent must be installed only on 64-bit architectures.</li> </ul>"},{"location":"WhalealPlatform/04-CreateDeployment/01-DeploymentPrerequisites/#server-networking-access","title":"Server Networking Access","text":"<p>The hosts that serve the MongoDB deployments must:</p> <ul> <li>Have full networking access to each other through their FQDNs. Each host must be able to reach every other host through the FQDN. To find the FQDN for each host, run the following command in the shell:</li> </ul> <p><code>hostname -f</code></p> <ul> <li>Set the Common Name or Subject Alternative Name value of any SSL certificates to the MongoDB host\u2019s FQDN.</li> </ul> <p>The network configuration must allow each MongoDB Agent to make a direct connection to every MongoDB deployment listed on the Deployment page. Whaleal does not support port forwarding.</p>"},{"location":"WhalealPlatform/04-CreateDeployment/01-DeploymentPrerequisites/#backup-and-monitoring","title":"Backup and Monitoring","text":"<p>Whaleal supports backup and monitoring only for MongoDB version 5.0 and later.</p>"},{"location":"WhalealPlatform/04-CreateDeployment/01-DeploymentPrerequisites/#mongodb-backup-support","title":"MongoDB  Backup Support","text":"<ul> <li>Increased disk usage, disk I/O, and network I/O on each MongoDB host with backup enabled while a snapshot is being taken.</li> <li>Increased inbound network load to the Agent host or hosts while a snapshot is being taken.</li> <li>Snapshots and backups use no storage capacity on Whaleal application.</li> </ul>"},{"location":"WhalealPlatform/04-CreateDeployment/01-DeploymentPrerequisites/#mongodb-agent-system-user-permissions","title":"MongoDB Agent System User Permissions","text":"<p>If you want the MongoDB Agent to manage your MongoDB deployments, the MongoDB Agent System User must have permission:</p> <ul> <li> <p>To stop the MongoDB processes. The MongoDB Agent System User restarts the processes using the agent's own set of MongoDB binaries.</p> </li> <li> <p>To <code>Read</code> and <code>Write</code> the MongoDB data directories and log directories.</p> </li> <li> <p>Set to the same user ID (UID) and group ID (GID) of the MongoDB process to be automated. If the MongoDB processes to be automated are not running as the same user and group, the Agent cannot manage those processes.</p> </li> </ul> <p>## EXAMPLE</p> <p>If your MongoDB Agent runs as the <code>mongod</code>system user in the <code>mongod</code>system group, the MongoDB process must also run as the <code>mongod</code> system user in the <code>mongod</code> system group.</p>"},{"location":"WhalealPlatform/04-CreateDeployment/01-DeploymentPrerequisites/#installation-options","title":"Installation Options","text":""},{"location":"WhalealPlatform/04-CreateDeployment/01-DeploymentPrerequisites/#installing-mongodb-enterprise-dependencies","title":"Installing MongoDB Enterprise Dependencies","text":""},{"location":"WhalealPlatform/04-CreateDeployment/01-DeploymentPrerequisites/#ubuntu","title":"Ubuntu","text":""},{"location":"WhalealPlatform/04-CreateDeployment/01-DeploymentPrerequisites/#ubuntu-1804","title":"Ubuntu 18.04","text":"<pre><code>sudo apt-get install \\\n     libcurl4 libgssapi-krb5-2 libldap-2.4-2 liblzma5 \\\n     libsasl2-2 libsasl2-modules \\\n     libsasl2-modules-gssapi-mit libwrap0 openssl snmp\n</code></pre>"},{"location":"WhalealPlatform/04-CreateDeployment/01-DeploymentPrerequisites/#ubuntu-2004","title":"Ubuntu 20.04","text":"<pre><code>sudo apt-get install \\\n     libcurl4 libgssapi-krb5-2 libldap-2.4-2 liblzma5 \\\n     libsasl2-2 libsasl2-modules \\\n     libsasl2-modules-gssapi-mit libwrap0 openssl snmp\n</code></pre>"},{"location":"WhalealPlatform/04-CreateDeployment/01-DeploymentPrerequisites/#ubuntu-2204","title":"Ubuntu 22.04","text":"<pre><code>sudo apt-get install \\\n     libcurl4 libgssapi-krb5-2 libldap-2.4-2 liblzma5 \\\n     libsasl2-2 libsasl2-modules \\\n     libsasl2-modules-gssapi-mit libwrap0 openssl snmp\n</code></pre>"},{"location":"WhalealPlatform/04-CreateDeployment/01-DeploymentPrerequisites/#rhelcentos","title":"RHEL/CentOS","text":""},{"location":"WhalealPlatform/04-CreateDeployment/01-DeploymentPrerequisites/#rhelcentos-6x","title":"RHEL/CentOS 6.x","text":"<pre><code>sudo yum install cyrus-sasl cyrus-sasl-gssapi \\\n     cyrus-sasl-plain krb5-libs libcurl net-snmp \\\n     net-snmp-libs openldap openssl xz-libs\n</code></pre>"},{"location":"WhalealPlatform/04-CreateDeployment/01-DeploymentPrerequisites/#rhelcentos-7x","title":"RHEL/CentOS 7.x","text":"<pre><code>sudo yum install cyrus-sasl cyrus-sasl-gssapi \\\n     cyrus-sasl-plain krb5-libs libcurl \\\n     lm_sensors-libs net-snmp net-snmp-agent-libs \\\n     openldap openssl tcp_wrappers-libs xz-libs\n</code></pre>"},{"location":"WhalealPlatform/04-CreateDeployment/01-DeploymentPrerequisites/#rhelcentos-8x","title":"RHEL/CentOS 8.x","text":"<pre><code>sudo yum install cyrus-sasl cyrus-sasl-gssapi \\\n     cyrus-sasl-plain krb5-libs libcurl \\\n     lm_sensors-libs net-snmp net-snmp-agent-libs \\\n     openldap openssl xz-libs\n</code></pre>"},{"location":"WhalealPlatform/04-CreateDeployment/01-DeploymentPrerequisites/#suse","title":"SUSE","text":""},{"location":"WhalealPlatform/04-CreateDeployment/01-DeploymentPrerequisites/#suse-12x","title":"SUSE 12.x","text":"<pre><code>sudo zypper install cyrus-sasl cyrus-sasl-plain \\\n     cyrus-sasl-gssapi krb5 libcurl4 libldap-2_4-2 \\\n     libopenssl1_0_0 libsensors4 libsnmp30 libwrap0 \\\n     liblzma5\n</code></pre>"},{"location":"WhalealPlatform/04-CreateDeployment/01-DeploymentPrerequisites/#suse-15x","title":"SUSE 15.x","text":"<pre><code>sudo zypper install cyrus-sasl cyrus-sasl-plain \\\n     cyrus-sasl-gssapi krb5 libcurl4 libldap-2_4-2 \\\n     libopenssl1_1 libsensors4 libsnmp30 libwrap0 \\\n     liblzma5\n</code></pre>"},{"location":"WhalealPlatform/04-CreateDeployment/01-DeploymentPrerequisites/#installing-to-a-host-before-installing-mongodb","title":"Installing to a Host Before Installing MongoDB","text":"<p>If you deploy the MongoDB Agent to a host onto which you want to have Automation install MongoDB, ensure the system user that owns the MongoDB Agent has <code>Read</code> and <code>Write</code> permissions on the MongoDB data and log directories you plan to use.</p>"},{"location":"WhalealPlatform/04-CreateDeployment/01-DeploymentPrerequisites/#installing-to-a-host-that-already-runs-mongodb","title":"Installing to a Host that Already Runs MongoDB","text":"<p>If you install the MongoDB Agent to a host on which Automation is managing a MongoDB process, the MongoDB Agent system user must have the following permissions:</p> <ul> <li>To stop the MongoDB process. The MongoDB Agent restarts the process using its own set of MongoDB binaries. If you had installed MongoDB with a package manager, use the same package manager to install the MongoDB Agent. This gives the MongoDB Agent the same owner as MongoDB.</li> <li>To <code>Read</code> and <code>Write</code> to the MongoDB data and log directories.</li> </ul>"},{"location":"WhalealPlatform/04-CreateDeployment/03-AddK8SCluster/","title":"Add K8S Cluster","text":"<p>premise\uff1a</p> <p>\u200b   Add k8s conifg in setting, refer to Kubernetes.</p> <ol> <li>Click Server&gt;K8S on the left side of the navigation bar</li> </ol> <p></p> <ol> <li>Click Add Stateful Set</li> </ol> <p></p> <ol> <li>Complete the configuration of the parameters in the figure below. There are no special requirements. NS and Stateful Set meet the production requirements.</li> </ol> <p></p> <ol> <li>Click Confirm.</li> </ol> <p>At this point, the K8S cluster is added.</p>"},{"location":"WhalealPlatform/04-CreateDeployment/04-DeployStandalone/","title":"Deploy a Standalone MongoDB Instance","text":"<p>Whaleal provides a wizard for adding your existing MongoDB deployments to monitoring and management. The wizard prompts you to:</p> <ul> <li>Install the Agent if you don't have it installed</li> <li>Identify the sharded cluster, the replica set, or the standalone to add. You can choose to add the deployment to Monitoring or to both Monitoring and Automation.</li> </ul>"},{"location":"WhalealPlatform/04-CreateDeployment/04-DeployStandalone/#procedure","title":"Procedure","text":""},{"location":"WhalealPlatform/04-CreateDeployment/04-DeployStandalone/#navigate-to-the-processes-tab-for-your-deployment","title":"Navigate to the Processes tab for your deployment.","text":"<ol> <li>If it is not already displayed, select the organization that contains your desired project from the Organizations menu in the navigation bar.</li> <li>If it is not already displayed, select your desired project from the Projects menu in the navigation bar.</li> <li>Click Processes in the sidebar.</li> </ol>"},{"location":"WhalealPlatform/04-CreateDeployment/04-DeployStandalone/#choose-new-standalone","title":"Choose New Standalone.","text":"<ol> <li>Click the Create Cluster dropdown menu.</li> </ol> <ol> <li>Select Standalone.</li> </ol>"},{"location":"WhalealPlatform/04-CreateDeployment/04-DeployStandalone/#configure-the-standalone-mongodb-instance","title":"Configure the standalone MongoDB instance.","text":"<p>In the Process Configuration section, complete the following fields.</p> Setting Description Name Type the name for your standalone MongoDB deployment. Version Select the MongoDB version for your standalone MongoDB deployment. Auth Schema Version Select the schema for storing the user data for your deployment. MongoDB 3.2 uses a different schema for user data than previous versions. Feature Compatibility (Optional) Select the feature compatibility set. This field appears if your deployment MongoDB version is <code>3.4</code> or later. Hostname Type the resolvable address for the host serving your MongoDB deployment. This can be a hostname or an IPv4 address. Port Type the IANA port number for your MongoDB deployment. The default for MongoDB deployments is <code>27017</code>. DB Directory Path Type the system path to the <code>database directory</code> for this deployment. The default is <code>/data/data_port</code>. Log File Path The log file and data file are in the same directory, and the directory cannot be customized. The default is <code>/data/data_port/mongodb.log</code>."},{"location":"WhalealPlatform/04-CreateDeployment/04-DeployStandalone/#set-any-advanced-configuration-options-for-the-standalone-mongodb-instance","title":"Set any Advanced Configuration options for the standalone MongoDB instance.","text":"<p>In the Advanced Configuration Options section, add any additional runtime options you want to set for your MongoDB deployment.</p> <p>To add an option:</p> <ol> <li>Click Add Option.</li> </ol> <p></p> <ol> <li> <p>Select a Startup Option.</p> </li> <li> <p>Set an acceptable value for that Startup Option.</p> </li> </ol>"},{"location":"WhalealPlatform/04-CreateDeployment/04-DeployStandalone/#click-create","title":"Click Create.","text":""},{"location":"WhalealPlatform/04-CreateDeployment/05-DeployReplicaSet/","title":"Deploy a Replica Set","text":"<p>Whaleal provides a wizard for adding your existing MongoDB deployments to monitoring and management. The wizard prompts you to:</p> <ul> <li>Install the Agent if you don't have it installed</li> <li>Identify the sharded cluster, the replica set, or the standalone to add. You can choose to add the deployment to Monitoring or to both Monitoring and Automation.</li> </ul>"},{"location":"WhalealPlatform/04-CreateDeployment/05-DeployReplicaSet/#considerations","title":"Considerations","text":""},{"location":"WhalealPlatform/04-CreateDeployment/05-DeployReplicaSet/#unique-names-for-replica-set","title":"Unique Names for Replica Set","text":"<p>Use a unique name for the replica set.</p>"},{"location":"WhalealPlatform/04-CreateDeployment/05-DeployReplicaSet/#important","title":"IMPORTANT","text":"<p>Replica set, sharded cluster, and shard names within the same project must be unique. Failure to have unique names for the deployments will result in broken backup snapshots.</p>"},{"location":"WhalealPlatform/04-CreateDeployment/05-DeployReplicaSet/#procedure","title":"Procedure","text":""},{"location":"WhalealPlatform/04-CreateDeployment/05-DeployReplicaSet/#navigate-to-the-deployment-page-for-your-project","title":"Navigate to the Deployment page for your project.","text":"<ol> <li>If it is not already displayed, select your desired project from the Projects menu in the navigation bar.</li> <li>If it is not already displayed, click MongoDB in the sidebar.</li> </ol>"},{"location":"WhalealPlatform/04-CreateDeployment/05-DeployReplicaSet/#open-the-cluster-creation-view","title":"Open the Cluster Creation View.","text":"<p>Click the Create Cluster arrow in the top-right of the MongoDB page. Select Replica Set from the drop-down menu to open the Create New Replica Set view.</p> <p></p>"},{"location":"WhalealPlatform/04-CreateDeployment/05-DeployReplicaSet/#configure-cluster-wide-settings","title":"Configure Cluster-Wide Settings.","text":"<p>The Replica Set Configuration section contains the following cluster-wide configuration settings. Settings marked with an * asterisk in the Whaleal UI are required**.</p> Setting Description Project Select the Project name of your replica set deployment. You cannot change this once set. Replica Set Settings Displays an table of each process associated with the replica set. You can configure the MongoDB server version, data directory of each process. Process Name Hostname and port of a <code>mongod</code> process. This hostname can be a hostname, or an IPv4 address. Whaleal initially groups each process under the replica set name. Click the replica name to display all <code>mongod</code> processes in the replica set.Whaleal applies any settings configured for the replica set to all of its associated processes. Version Select the MongoDB server version of the <code>mongod</code> process. Data Directory Specify the directory where the <code>mongod</code> process stores data files. This setting corresponds to the <code>storage.dbPath</code> <code>mongod</code> configuration file option. The Whaleal Automation must have file system permission to read, write, and execute all files and folders in the specified directory.Each <code>mongod</code> process must have its own database directory. If deploying multiple <code>mongod</code> processes on the same host, ensure each process has its own distinct directory. Log File The log file and data file are in the same directory, and the directory cannot be customized."},{"location":"WhalealPlatform/04-CreateDeployment/05-DeployReplicaSet/#configure-each-replica-set-member","title":"Configure each Replica Set Member.","text":"<p>Whaleal lists each replica set member under the MongoD Settings heading of the Member Configuration section. Each replica set member has the following options:</p> Setting Description Member Select one of the following replica set member roles from the menu:<code>Ordinary member node</code>A data-bearing member of the replica set that can become the primary and vote in elections.<code>Hidden node</code>A data-bearing member of the replica set that can vote in elections. Corresponds to the hidden replica configuration option.<code>Hidden delay node</code>A data-bearing member of the replica set that can vote in elections. Hostname Select from the menu the host to which Whaleal Automation deploys the replica set member. The menu only lists hosts under Whaleal Automation. For complete documentation on adding servers to Whaleal Automation.This hostname can be a hostname or an IPv4 address. Port Specify the IANA port number for the <code>mongod</code>process. This setting corresponds to the <code>net.port</code> configuration file option.The <code>mongod</code> must have exclusive access to the specified port. If deploying multiple <code>mongod</code> processes to a single host, you must select a unique unused port for each process. Votes Specify the number of votes that the replica set member has during elections. This setting corresponds to the <code>votes</code> <code>mongod</code> replica set configuration option. Priority Specify the priority of the member during elections. Replica set members with a priority of <code>0</code> cannot become the primary node and cannot trigger elections. This setting corresponds to the <code>priority</code> <code>mongod</code> replica set configuration option. Delay Specify the number of seconds \"behind\" the primary member this member should \"lag\". This setting corresponds to the <code>secondaryDelaySecs</code> <code>mongod</code>replica set configuration option. Add a Mongod Adds an additional <code>mongod</code> process as a replica set member.Adding a new <code>mongod</code> process also updates the list of processes in the Replica Set Configuration section. You must configure the Version and Data Directory of the new process. Build Indexes Specify <code>true</code> to direct the <code>mongod</code> to build indexes. This setting corresponds to the <code>buildIndexes</code> <code>mongod</code> replica set configuration option."},{"location":"WhalealPlatform/04-CreateDeployment/05-DeployReplicaSet/#configure-your-replication-settings","title":"Configure your Replication Settings.","text":"<p>The Replication Settings section contains the following configuration options for the replica set:</p> Setting Description Protocol Version Select the replication protocol version used by the replica set. This setting corresponds to the <code>protocolVersion</code> replica set configuration option. Chaining Allowed Specify <code>true</code> to allow secondary members to replicate from other secondary members. This setting corresponds to the <code>chainingAllowed</code> replica set configuration option. Write Concern Majority Journal Default Determines the behavior of <code>{w:\"majority\"}</code> write concern if the write concern does not explicitly specify the journal option <code>j</code>. This setting corresponds to the <code>writeConcernMajorityJournalDefault</code> replica set configuration option. Heartbeat Timeout (secs) Specify the number of seconds that the replica set members wait for a successful heartbeat from each other. This setting corresponds to the <code>heartbeatTimeoutSecs</code> replica set configuration option. Election Timeout (ms) Specify the time limit in milliseconds for detecting when a replica set's primary is unreachable. This setting corresponds to the <code>electionTimeoutMillis</code> replica set configuration option. CatchUp Timeout (ms) Specify the time limit in milliseconds for a newly elected primary to sync, or catch up, with the other replica set members that may have more recent writes. This setting corresponds to the <code>catchUpTimeoutMillis</code> replica set configuration option. CatchUp Takeover Delay (ms) Specify the time in milliseconds a node waits to initiate a catchup takeover after determining it is ahead of the current primary. This setting corresponds to the <code>catchUpTakeoverDelayMillis</code> replica set configuration option."},{"location":"WhalealPlatform/04-CreateDeployment/05-DeployReplicaSet/#set-the-default-read-and-write-concerns-for-your-mongodb-replica-set","title":"Set the default read and write concerns for your MongoDB replica set.","text":"<p>In the Default Read Concerns/Write Concerns card, you configure the default level of acknowledgement requested from MongoDB for read and write operations for this cluster. Setting the default read and write concern can help with MongoDB 5.0 and later deployments using arbiters.</p> <p>From the Default Read Concerns section, you can set consistency and isolation properties for the data read from the cluster.</p> <p>Select the default read concern from the Level dropdown menu. You can choose from the following values:</p> <ul> <li>local, the MongoDB 5.0 and later default value,</li> <li>available, the MongoDB 4.4 default value, or</li> <li>majority.</li> </ul>"},{"location":"WhalealPlatform/04-CreateDeployment/05-DeployReplicaSet/#set-any-advanced-configuration-options-for-your-mongodb-replica-set","title":"Set any advanced configuration options for your MongoDB replica set.","text":"<p>The Advanced Configuration Options section allows you to set MongoDB runtime options for each MongoDB process in your deployment.</p> <p>To add an option:</p> <ol> <li>Click Advanced Configuration.</li> </ol> <p></p> <ol> <li> <p>Click Add Option and select the configuration option.</p> </li> <li> <p>Whaleal displays a context-sensitive input for configuring an acceptable value for the selected option.</p> </li> <li> <p>Click Confirm to add the selected option and its corresponding value to every process of the selected process type in the cluster.</p> </li> </ol>"},{"location":"WhalealPlatform/04-CreateDeployment/05-DeployReplicaSet/#click-create-replica-set","title":"Click Create Replica Set.","text":"<p>Whaleal automatically deploys the replica set as configured. You can monitor the progress of cluster deployment from the Deployment view.</p>"},{"location":"WhalealPlatform/04-CreateDeployment/06-DeployShardedCluster/","title":"Deploy a Sharded Cluster","text":"<p>Whaleal provides a wizard for adding your existing MongoDB deployments to monitoring and management. The wizard prompts you to:</p> <ul> <li>Install the Agent if you don't have it installed</li> <li>Identify the sharded cluster, the replica set, or the standalone to add. You can choose to add the deployment to Monitoring or to both Monitoring and Automation.</li> </ul>"},{"location":"WhalealPlatform/04-CreateDeployment/06-DeployShardedCluster/#considerations","title":"Considerations","text":""},{"location":"WhalealPlatform/04-CreateDeployment/06-DeployShardedCluster/#unique-names-for-sharded-clusters","title":"Unique Names for Sharded Clusters","text":"<p>Use unique names for the new cluster and its shards.</p>"},{"location":"WhalealPlatform/04-CreateDeployment/06-DeployShardedCluster/#important","title":"IMPORTANT","text":"<p>Replica set, sharded cluster, and shard names within the same project must be unique. Failure to have unique names for the deployments will result in broken backup snapshots.</p>"},{"location":"WhalealPlatform/04-CreateDeployment/06-DeployShardedCluster/#procedure","title":"Procedure","text":""},{"location":"WhalealPlatform/04-CreateDeployment/06-DeployShardedCluster/#navigate-to-the-deployment-page-for-your-project","title":"Navigate to the Deployment page for your project.","text":"<ul> <li>If it is not already displayed, select your desired project from the Projects menu in the navigation bar.</li> <li>If it is not already displayed, click MongoDB in the sidebar.</li> </ul>"},{"location":"WhalealPlatform/04-CreateDeployment/06-DeployShardedCluster/#open-the-cluster-creation-view","title":"Open the Cluster Creation View.","text":"<p>Click the Create Cluster arrow in the top-right of the MongoDB page. Select Sharding Cluster from the drop-down menu to open the Create Sharding Cluster view.</p> <p></p>"},{"location":"WhalealPlatform/04-CreateDeployment/06-DeployShardedCluster/#configure-cluster-wide-settings","title":"Configure Cluster-Wide Settings.","text":"<p>The Cluster Configuration section contains the following cluster-wide configuration settings. Settings marked with an * asterisk in the Whaleal UI are required**.</p> Setting Description Cluster Name Specify the name of your sharded cluster deployment. You cannot change this once set. Config Server Replica Set Name Specify the name of your Config Server Replica Set. You cannot change this once set. This setting corresponds to the <code>_id</code> replica configuration option.Whaleal only displays this option if you selected MongoDB 3.2 or later as the Version of your configuration servers. Shard Name Prefix Specify the prefix of each shard in the cluster. Whaleal names each shard in the cluster using the <code>&lt;prefix_n&gt;</code> format, where <code>n</code> is a 0-indexed, monotonically increasing integer. Process Name Hostname and port of a <code>mongod</code> or <code>mongos</code> associated to the sharded cluster. This hostname can be a hostname or an IPv4 address.Whaleal groups <code>mongod</code> processes under their parent replica set name, and <code>mongos</code> processes under mongoses. Whaleal then groups all the cluster components under the cluster name. Click the to the left of a grouping to list its sub-groups or processes. Modifying any of the available settings for a grouping changes the corresponding value in its sub-groups and processes.NOTEFor clusters running MongoDB 3.2 or earlier, Whaleal groups the config server <code>mongod</code>processes under configServers. Version Select the MongoDB server version of the <code>mongod</code> or <code>mongos</code> process. Data Directory Specify the directory where the <code>mongod</code> process stores data files. This setting corresponds to the <code>storage.dbPath</code> <code>mongod</code> configuration file option. The Whaleal Automation must have file system permission to read, write, and execute all files and folders in the specified directory.Each <code>mongod</code> process must have its own database directory. If deploying multiple <code>mongod</code> processes on the same host, ensure each process has its own distinct directory. Log File The log file and data file are in the same directory, and the directory cannot be customized."},{"location":"WhalealPlatform/04-CreateDeployment/06-DeployShardedCluster/#configure-each-shard-in-your-cluster","title":"Configure Each Shard in Your Cluster.","text":"<p>From the Member Configuration section, click Shard Settings to open the shard configuration options. Whaleal lists each shard in the cluster and the <code>mongod</code> processes associated to that shard. Each shard process has the following options:</p> Setting Description Member Select one of the following replica set member roles from the menu:<code>Ordinary member node</code>A data-bearing member of the replica set that can become the primary and vote in elections.<code>Hidden node</code>A data-bearing member of the replica set that can vote in elections. Corresponds to the hidden replica configuration option.<code>Hidden delay node</code>A data-bearing member of the replica set that can vote in elections. Hostname Select from the menu the host to which Whaleal Automation deploys the replica set member. The menu only lists hosts under Whaleal Automation. For complete documentation on adding servers to Whaleal Automation.This hostname can be a hostname or an IPv4 address. Port Specify the IANA port number for the <code>mongod</code>process. This setting corresponds to the <code>net.port</code> configuration file option.The <code>mongod</code> must have exclusive access to the specified port. If deploying multiple <code>mongod</code> processes to a single host, you must select a unique unused port for each process. Votes Specify the number of votes that the replica set member has during elections. This setting corresponds to the <code>votes</code> <code>mongod</code> replica set configuration option. Priority Specify the priority of the member during elections. Replica set members with a priority of <code>0</code> cannot become the primary node and cannot trigger elections. This setting corresponds to the <code>priority</code> <code>mongod</code> replica set configuration option. Delay Specify the number of seconds \"behind\" the primary member this member should \"lag\". This setting corresponds to the <code>secondaryDelaySecs</code> <code>mongod</code>replica set configuration option. Add a Mongod Adds an additional <code>mongod</code> process as a replica set member.Adding a new <code>mongod</code> process also updates the list of processes in the Replica Set Configuration section. You must configure the Version and Data Directory of the new process. Build Indexes Specify <code>true</code> to direct the <code>mongod</code> to build indexes. This setting corresponds to the <code>buildIndexes</code> <code>mongod</code> replica set configuration option. <p>To add additional shards to the cluster:</p> <ol> <li>Click Add a Shard.</li> <li>Under the Cluster Configuration section, set the following parameters for each <code>mongod</code> in the shard:</li> <li>Version</li> <li>Data Directory</li> </ol>"},{"location":"WhalealPlatform/04-CreateDeployment/06-DeployShardedCluster/#configure-each-configuration-server-in-your-cluster","title":"Configure Each Configuration Server in Your Cluster.","text":"Setting Description Member Select one of the following replica set member roles from the menu:<code>Ordinary member node</code>:  A data-bearing member of the replica set that can become the primary and vote in elections.<code>Hidden node</code>:  A data-bearing member of the replica set that can vote in elections. Corresponds to the <code>hidden</code> replica configuration option.<code>Hidden Delayed node</code> :  A data-bearing member of the replica set that can vote in elections. Corresponds to the <code>secondaryDelaySecs</code> and <code>hidden</code> replica configuration options. Hostname Select from the menu the host to which Whaleal Automation deploys the replica set member. The menu only lists hosts under Whaleal Automation. This hostname can be a hostname or an IPv4 address. Port Specify the IANA port number for the <code>mongod</code> process. This setting corresponds to the <code>net.port</code> configuration file option. Defaults to <code>27017</code>.The <code>mongod</code> must have exclusive access to the specified port. If deploying multiple <code>mongod</code> processes to a single host, you must select a unique unused port for each process. Votes Specify the number of votes that the replica set member has during elections. This setting corresponds to the <code>votes</code> <code>mongod</code> replica set configuration option. Priority Specify the priority of the member during elections. Replica set members with a priority of <code>0</code> cannot become the primary and cannot trigger elections. This setting corresponds to the <code>priority</code> <code>mongod</code> replica set configuration option. Delay Specify the number of seconds \"behind\" the primary member this member should \"lag\". This setting corresponds to the <code>secondaryDelaySecs</code> <code>mongod</code> replica set configuration option. Build Indexes Specify <code>true</code> to direct the <code>mongod</code>] to build indexes. This setting corresponds to the <code>buildIndexes</code> <code>mongod</code> replica set configuration option. This setting corresponds to the <code>tags</code> <code>mongod</code> replica set configuration option. Add a Mongod Adds an additional <code>mongod</code> process as a replica set member.Adding a new <code>mongod</code> process also updates the list of processes in the Cluster Configuration section. You must configure the Version  and Data Directory of the new process."},{"location":"WhalealPlatform/04-CreateDeployment/06-DeployShardedCluster/#configure-each-mongos-in-your-cluster","title":"Configure Each <code>mongos</code> in Your Cluster.","text":"<p>From the Member Configuration section, click Mongos Settings to open the <code>mongos</code> configuration options. Each <code>mongos</code> process has the following options:</p> Setting Description Hostname Select from the menu the host to which Whaleal Automation deploys the <code>mongos</code>. The menu only lists hosts under Whaleal Automation. For complete documentation on adding servers to Whaleal Automation. This hostname can be a hostname or an IPv4 address. Port Specify the IANA port number for the <code>mongos</code> process. This setting corresponds to the <code>net.port</code> configuration file option. Defaults to <code>27017</code>.The <code>mongos</code> must have exclusive access to the specified port. If deploying multiple <code>mongos</code> processes to a single host, you must select a unique unused port for each process. Add a Mongos Click to add an additional <code>mongos</code> process."},{"location":"WhalealPlatform/04-CreateDeployment/06-DeployShardedCluster/#configure-each-replica-set-in-your-cluster","title":"Configure Each Replica Set in your Cluster.","text":"<p>The Replication Settings section contains the following configuration options for each replica set in the cluster:</p> Setting Description Protocol Version Select the replication protocol version used by the replica set. This setting corresponds to the <code>protocolVersion</code> replica set configuration option.For more information, see Replica Set Protocol Versions. Chaining Allowed Specify <code>true</code> to allow secondary members to replicate from other secondary members. This setting corresponds to the <code>chainingAllowed</code> replica set configuration option. Write Concern Majority Journal Default Determines the behavior of <code>{w:\"majority\"}</code> write concern if the write concern does not explicitly specify the journal option <code>j</code>. This setting corresponds to the <code>writeConcernMajorityJournalDefault</code>replica set configuration option. Heartbeat Timeout (secs) Specify the number of seconds that the replica set members wait for a successful heartbeat from each other. This setting corresponds to the <code>heartbeatTimeoutSecs</code> replica set configuration option. Election Timeout (ms) Specify the time limit in milliseconds for detecting when a replica set's primary is unreachable. This setting corresponds to the <code>electionTimeoutMillis</code> replica set configuration option. CatchUp Timeout (ms) Specify the time limit in milliseconds for a newly elected primary to sync, or catch up, with the other replica set members that may have more recent writes. This setting corresponds to the <code>catchUpTimeoutMillis</code>replica set configuration option. CatchUp Takeover Delay (ms) Specify the time in milliseconds a node waits to initiate a catchup takeover after determining it is ahead of the current primary. This setting corresponds to the <code>catchUpTakeoverDelayMillis</code> replica set configuration option."},{"location":"WhalealPlatform/04-CreateDeployment/06-DeployShardedCluster/#set-the-default-read-and-write-concerns-for-your-mongodb-replica-set","title":"Set the default read and write concerns for your MongoDB replica set.","text":"<p>In the Default Read Concerns/Write Concerns card, you configure the default level of acknowledgement requested from MongoDB for read and write operations for this cluster. Setting the default read and write concern can help with MongoDB 5.0 and later deployments using arbiters.</p> <p>From the Default Read Concerns section, you can set consistency and isolation properties for the data read from the cluster.</p> <p>Select the default read concern from the Level dropdown menu. You can choose from the following values:</p> <ul> <li>local, the MongoDB 5.0 and later default value,</li> <li>available, the MongoDB 4.4 default value, or</li> <li>majority.</li> </ul>"},{"location":"WhalealPlatform/04-CreateDeployment/06-DeployShardedCluster/#set-any-advanced-configuration-options-for-your-mongodb-replica-set","title":"Set any advanced configuration options for your MongoDB replica set.","text":"<p>The Advanced Configuration Options section allows you to set MongoDB runtime options for each MongoDB process in your deployment.</p> <p>To add an option:</p> <ol> <li>Click Advanced Configuration.</li> </ol> <p></p> <ol> <li> <p>Click Add Option and select the configuration option.</p> </li> <li> <p>Whaleal displays a context-sensitive input for configuring an acceptable value for the selected option.</p> </li> <li> <p>Click Confirm to add the selected option and its corresponding value to every process of the selected process type in the cluster.</p> </li> </ol>"},{"location":"WhalealPlatform/04-CreateDeployment/06-DeployShardedCluster/#click-create-cluster","title":"Click Create Cluster.","text":"<p>Whaleal redirects you to the MongoDB List view, where you must review the cluster configuration before Whaleal begins deployment.</p>"},{"location":"WhalealPlatform/04-CreateDeployment/07-DeployExistingCluster/","title":"Add Existing MongoDB Processes to Whaleal","text":""},{"location":"WhalealPlatform/04-CreateDeployment/07-DeployExistingCluster/#considerations","title":"Considerations","text":""},{"location":"WhalealPlatform/04-CreateDeployment/07-DeployExistingCluster/#unique-names","title":"Unique Names","text":"<p>Deployments must have unique names within the projects.</p>"},{"location":"WhalealPlatform/04-CreateDeployment/07-DeployExistingCluster/#important","title":"IMPORTANT","text":"<p>Replica set, sharded cluster, and shard names within the same project must be unique. Failure to have unique names for the deployments will result in broken backup snapshots.</p>"},{"location":"WhalealPlatform/04-CreateDeployment/07-DeployExistingCluster/#preferred-hostnames","title":"Preferred Hostnames","text":"<p>Set up a preferred hostname if you:</p> <ul> <li>Require a specific hostname or IPv4 address to access the MongoDB process, or</li> <li>Must specify the hostname to use for hosts with multiple aliases.</li> </ul>"},{"location":"WhalealPlatform/04-CreateDeployment/07-DeployExistingCluster/#authentication-credentials-on-source-and-destination-clusters","title":"Authentication Credentials on Source and Destination Clusters","text":"<p>If the Whaleal project has MongoDB authentication settings enabled for its deployments, the MongoDB deployment you import must support the project's authentication mechanism.</p> <p>We recommend that you import to a new destination project that has no running processes and doesn't have authentication enabled.</p> <p>If the source cluster uses authentication, and the destination Whaleal project doesn't have any existing managed processes, Whaleal enables authentication in the destination project, Back up the source keyfile and then rewrite the keyfile, and uses it to authenticate the user that conducts the import process.</p> <p>If the source cluster and the destination Whaleal project both use authentication, and the project has processes, Whaleal attempts to use existing authentication settings in the destination project during the import process. For the import process to succeed, authentication credentials on the source cluster and the Whaleal destination project must be the same.</p> <p>To ensure that import is successful, before you start the import process, add the Whaleal destination project's credentials on the source cluster. </p>"},{"location":"WhalealPlatform/04-CreateDeployment/07-DeployExistingCluster/#authentication-use-cases","title":"Authentication Use Cases","text":"<p>If your MongoDB deployment requires authentication, when you add the deployment to Whaleal for monitoring, you must provide the necessary credentials.</p> <ul> <li> <p>If the deployment doesn't use Automation, but did use Backup, Monitoring, or both, you can find those credentials where the credentials were before updating to the MongoDB Agent.</p> </li> <li> <p>If the deployment doesn't use Automation, but will use Backup, Monitoring, or both:</p> </li> <li>Create the credentials for the MongoDB Deployment. </li> <li> <p>Add the credentials that you granted to those functions to Whaleal after you add the MongoDB processes. </p> </li> <li> <p>If the deployment uses Automation,  Whaleal uses the credentials from the Agent. You can delete the credentials from the legacy Backup, and Monitoring Agents. The Agent uses those credentials for its Automation, Backup, and Monitoring functions.</p> </li> </ul>"},{"location":"WhalealPlatform/04-CreateDeployment/07-DeployExistingCluster/#automation-and-updated-security-settings-upon-import","title":"Automation and Updated Security Settings Upon Import","text":"<p>Adding a MongoDB deployment to automation may affect the security settings of the Whaleal project and the MongoDB deployment.</p> <ul> <li>Automation enables the Project Security Setting. If the MongoDB deployment requires authentication but the Whaleal project doesn't have authentication settings enabled, when you add the MongoDB deployment to automation, Whaleal updates the project's security settings to the security settings of the newly imported deployment.</li> </ul> <p>The import process only updates the Whaleal project's security setting if the project's security setting is currently disabled. The import process doesn't disable the project's security setting or change its enabled authentication mechanism.</p> <ul> <li>Automation Imports MongoDB Users and Roles. The following statements apply to situations where a MongoDB deployment requires authentication or the Whaleal project has authentication settings enabled.</li> </ul> <p>If the MongoDB deployment contains users or user-defined roles, you can choose to import these users and roles for Whaleal to manage. The imported users and roles are Synced to all managed deployments in the Whaleal project.</p> <ul> <li>Automation Applies to All Deployments in the Project. The project's updated security settings, including all users and roles managed by the Whaleal project, apply to all deployments in the project, including the imported MongoDB deployment.</li> </ul> <p>Whaleal restarts all deployments in the project with the new setting, including the imported MongoDB deployment. After import, all deployments in the project use the Whaleal automation keyfile upon restart.</p> <ul> <li>When using Whalea to manage MongoDB, Whaleal will create a wapAdmin user on the managed MongoDB. Whaleal manages the managed MongoDB through the wapAdmin user, which has administrator user privileges.</li> </ul>"},{"location":"WhalealPlatform/04-CreateDeployment/07-DeployExistingCluster/#prerequisites","title":"Prerequisites","text":"<ul> <li> <p>If mongod is enabled as a service on the deployment, a race condition might result where <code>systemd</code> starts <code>mongod</code> on reboot, rather than the Automation. To prevent this issue, ensure the <code>mongod</code> service is disabled before you add your deployment to Automation:</p> </li> <li> <p>Verify whether the <code>mongod</code> service is enabled:</p> </li> </ul> <p><code>shell   sudo systemctl is-enabled mongod.service</code></p> <ul> <li>If the service is enabled, disable it:</li> </ul> <p><code>shell   sudo systemctl disable mongod.service</code></p>"},{"location":"WhalealPlatform/04-CreateDeployment/07-DeployExistingCluster/#important_1","title":"IMPORTANT","text":"<p>If you are adding a sharded cluster, you must create this user through the mongos and on every shard. That is, create the user both as a cluster wide user through mongos as well as a shard local user on each shard.</p>"},{"location":"WhalealPlatform/04-CreateDeployment/07-DeployExistingCluster/#procedures","title":"Procedures","text":""},{"location":"WhalealPlatform/04-CreateDeployment/07-DeployExistingCluster/#add-mongodb-processes","title":"Add MongoDB Processes","text":"<p>To add existing MongoDB processes to Whaleal:</p>"},{"location":"WhalealPlatform/04-CreateDeployment/07-DeployExistingCluster/#1-navigate-to-the-mongodb-page-for-your-project","title":"1.  Navigate to the MongoDB page for your project.","text":"<p>\u200b   a. If it is not already displayed, select your desired project from the Projects menu in the navigation bar.</p> <p>\u200b   b.If it is not already displayed, click Deployment in the sidebar.</p>"},{"location":"WhalealPlatform/04-CreateDeployment/07-DeployExistingCluster/#2-click-add-and-select-existing-mongodb-deployment","title":"2. Click Add and select Existing MongoDB Deployment.","text":""},{"location":"WhalealPlatform/04-CreateDeployment/07-DeployExistingCluster/#3-follow-the-prompts-to-add-the-deployment","title":"3. Follow the prompts to add the deployment","text":"Cluster name Cluster name is the cluster name displayed on Whaleal Project In the drop-down box, select the cluster to which you want to manage MongoDB. Host Name Select the node where the MongoDB to be managed is located. Port Enter the port number of the MongoDB node to be managed. User Name The user of the Mongodb that needs to be managed. Password The password of the Mongodb that needs to be managed. Version Select the version of MongoDB that needs to be managed. If there is no suitable version, please upload the relevant version of MongoDB package in Setting&gt;&gt;MongoDB Packge."},{"location":"WhalealPlatform/04-CreateDeployment/07-DeployExistingCluster/#4after-the-configuration-is-complete-click-submit","title":"4.After the configuration is complete, click Submit","text":""},{"location":"WhalealPlatform/04-CreateDeployment/02-AddEC2/01-ResourceQuota/","title":"Resoucrce Quota","text":"<p>When adding an ec2 instance using a manually built WAP, the default resource quota is five ec2 instances.</p> <p>When adding more than five ec2 instances, further addition will fail. You can contact us according to the information in the yellow prompt bar.</p> <p></p>"},{"location":"WhalealPlatform/04-CreateDeployment/02-AddEC2/02-SubscribeAgent/","title":"Subscribe Agent","text":"<ol> <li> <p>Subscribe to Whaleal Platform Agent, refer to Install Whaleal in AWS MarketPlace</p> </li> <li> <p>Connecting to EC2 Instance</p> </li> </ol> <p><code>shell    sudo -i</code></p> <ol> <li>Enter the /opt directory</li> </ol> <p><code>shell    cd /opt/agent</code></p> <ol> <li>Modify the /opt/agent/parameters.properties file</li> </ol> <p>```shell    vi parameters.properties</p> <p>#Modify the first line    #In the configuration item \"foreign_url=\", replace Whaleal_Public_IP with Whaleal's public IP as follows    foreign_url=http://Whaleal_Public_IP:8080    ```</p> <ol> <li>Restart the agent.</li> </ol> <p><code>shell    ps -ef | grep agent    kill -9 Agent_PID</code></p> <p>Wait two minutes and check to confirm that the agent has automatically restarted</p> <ol> <li>Go to Whaleal to check the EC2 management progress.</li> </ol> <p></p>"},{"location":"WhalealPlatform/04-CreateDeployment/02-AddEC2/03-ManuallyAddAgent/","title":"Manually add Agent","text":"<ol> <li> <p>Start the EC2 instance and connect to it</p> </li> <li> <p>Visit Whaleal and click Server&gt;EC2&gt;Add Host&gt;Mode One on the left side of the navigation bar</p> </li> </ol> <p></p> <ol> <li>Select Project, then click Generate AGENT_ID</li> </ol> <p></p> <ol> <li>Install the agent</li> </ol> <p>Follow the prompts to execute all commands</p> <p></p> <ol> <li>View the agent process</li> </ol> <p><code>shell    ps -ef | grep agent</code></p> <ol> <li>Go to Whaleal to check the EC2 management progress.</li> </ol> <p></p>"},{"location":"WhalealPlatform/05-ManageDeployments/01-ViewAllClusters/","title":"View All Clusters","text":""},{"location":"WhalealPlatform/05-ManageDeployments/01-ViewAllClusters/#note","title":"NOTE","text":"<p>For an Whaleal administrator, the view displays all deployments to which the administrator has access, not just those to which the administrator belongs.</p>"},{"location":"WhalealPlatform/05-ManageDeployments/01-ViewAllClusters/#access-all-clusters-view","title":"Access All Clusters View","text":"<p>First, click MongoDB in the left navigation bar of Whaleal. Upon navigating to the MongoDB List page, you will have the option to filter clusters by various criteria. Administrator users can search and view all clusters without applying any filters. Additionally, clusters can be precisely filtered based on criteria such as Project, Type, Cluster Name, Node Name, or Operating System. Non-administrator users will only be able to view clusters within public projects or projects to which they have been granted access permissions.</p>"},{"location":"WhalealPlatform/05-ManageDeployments/01-ViewAllClusters/#_1","title":"View All Clusters","text":""},{"location":"WhalealPlatform/05-ManageDeployments/02-EditDeploymentConfiguration/","title":"Edit a Deployment's Configuration","text":"<p>You can modify a deployment's configuration and topology, including its MongoDB versions, and numbers of hosts or shards. You can make modifications at all levels of a deployment's topology from a top-level sharded cluster or replica set to lower levels, such as a replica set within a sharded cluster, or an individual process within a replica set. You can also modify standalone processes.</p>"},{"location":"WhalealPlatform/05-ManageDeployments/02-EditDeploymentConfiguration/#considerations","title":"Considerations","text":""},{"location":"WhalealPlatform/05-ManageDeployments/02-EditDeploymentConfiguration/#mongodb-version","title":"MongoDB Version","text":"<p>Whaleal is applicable to MongoDB5.0 and later versions\uff0cyou can also manage versions before 5.0, but some functions may not be available and occasional problems may occur.</p>"},{"location":"WhalealPlatform/05-ManageDeployments/02-EditDeploymentConfiguration/#fixed-properties","title":"Fixed Properties","text":"<p>You cannot modify the following settings after a deployment has been created:</p> <ul> <li><code>database path</code></li> <li>The hostname, <code>bind_ip</code> or <code>port</code> to which a MongoDB process is assigned</li> </ul> <p>You can modify the following deployment settings:</p> <ul> <li>advanced options</li> </ul>"},{"location":"WhalealPlatform/05-ManageDeployments/02-EditDeploymentConfiguration/#deployment-topology","title":"Deployment Topology","text":"<p>You can make modifications at all levels of a deployment's topology, including child processes.</p> <p>To modify the topology or processes, use this tutorial or one of the more specific tutorials:</p> <ul> <li>Convert a Standalone to a Replica Set</li> <li>Convert a Replica Set to a Shard Cluster</li> </ul>"},{"location":"WhalealPlatform/05-ManageDeployments/02-EditDeploymentConfiguration/#removing-a-shard","title":"Removing a Shard","text":"<p>For Sharded Clusters Only</p> <p>When you remove a shard, any unsharded databases in that shard are moved to a remaining shard using the movePrimary command.</p> <p>All sharded collections remain online and available during the shard removal process. However, read and write operations sent to unsharded collections during the <code>movePrimary</code> operation can result in unexpected behavior, including failure of the migration or loss of data.</p> <p>We recommend moving the primary shard for any databases containing unsharded collections before removing the shard.</p>"},{"location":"WhalealPlatform/05-ManageDeployments/02-EditDeploymentConfiguration/#removing-multiple-replica-set-members","title":"Removing Multiple Replica Set Members","text":"<p>You can remove or migrate multiple replica set members at once, but a majority of the voting members must remain. If you need to remove more voting members, remove them one at a time.</p>"},{"location":"WhalealPlatform/05-ManageDeployments/02-EditDeploymentConfiguration/#procedure","title":"Procedure","text":"<p>Select the type of deployment you want to edit:</p>"},{"location":"WhalealPlatform/05-ManageDeployments/02-EditDeploymentConfiguration/#standalone","title":"Standalone","text":""},{"location":"WhalealPlatform/05-ManageDeployments/02-EditDeploymentConfiguration/#in-the-operation-drop-down-list-next-to-the-deployed-cluster-click-cluster-modify","title":"In the Operation drop-down list next to the deployed cluster, click Cluster Modify.","text":""},{"location":"WhalealPlatform/05-ManageDeployments/02-EditDeploymentConfiguration/#modify-advanced-configuration-options","title":"Modify Advanced Configuration Options.","text":"<p>The Advanced Configuration Options section allows you to set MongoDB runtime options for each MongoDB process in your deployment.</p> <p>To add an option:</p> <ol> <li>Click Add Option.</li> </ol> <p></p> <ol> <li>Click Select and select the configuration option.</li> </ol> <p></p> <ol> <li> <p>Whalel displays a context-sensitive input for configuring an acceptable value for the selected option.</p> </li> <li> <p>Click Comfirm to add the selected option and its corresponding value to the process.</p> </li> </ol>"},{"location":"WhalealPlatform/05-ManageDeployments/02-EditDeploymentConfiguration/#click-update","title":"Click Update.","text":""},{"location":"WhalealPlatform/05-ManageDeployments/02-EditDeploymentConfiguration/#replica-set","title":"Replica Set","text":""},{"location":"WhalealPlatform/05-ManageDeployments/02-EditDeploymentConfiguration/#in-the-operation-drop-down-list-next-to-the-deployed-cluster-click-cluster-modify_1","title":"In the Operation drop-down list next to the deployed cluster, click Cluster Modify.","text":""},{"location":"WhalealPlatform/05-ManageDeployments/02-EditDeploymentConfiguration/#modify-cluster-wide-settings","title":"Modify Cluster-Wide Settings.","text":"<p>The Replica Set Configuration section contains the following cluster-wide configuration settings.\\</p> <p></p>"},{"location":"WhalealPlatform/05-ManageDeployments/02-EditDeploymentConfiguration/#configure-each-replica-set-member","title":"Configure Each Replica Set Member.","text":"<p>Whaleal lists each replica set member under the Update Replica Set heading of the Member Configuration section. Each replica set member has the following configurable options:</p> <p></p> Setting Description Member Select one of the following replica set member roles from the menu:<code>Default</code>: A data-bearing member of the replica set that can become the primary and vote in elections.<code>Hidden</code>: A data-bearing member of the replica set that can vote in elections. Corresponds to the <code>hidden</code> replica configuration option.<code>Delayed Hidden</code>: A data-bearing member of the replica set that can vote in elections. Corresponds to the <code>secondaryDelaySecs</code> and <code>hidden</code> replica configuration options. Hostname Select from the menu the host to which Whaleal Automation deploys the replica set member. The menu only lists hosts under Whaleal Automation. This hostname can be a hostname or an IPv4 address. Port Specify the IANA port number for the <code>mongod</code> process. This setting corresponds to the <code>net.port</code> configuration file option. The <code>mongod</code> must have exclusive access to the specified port. If deploying multiple <code>mongod</code> processes to a single host, you must select a unique unused port for each process. Votes Specify the number of votes that the replica set member has during elections. This setting corresponds to the <code>votes</code> <code>mongod</code> replica set configuration option. Priority Specify the priority of the member during elections. Replica set members with a priority of <code>0</code> cannot become the primary and cannot trigger elections. This setting corresponds to the <code>priority</code> <code>mongod</code>] replica set configuration option. Delay Specify the number of seconds \"behind\" the primary member this member should \"lag\". This setting corresponds to the <code>secondaryDelaySecs</code> <code>mongod</code> replica set configuration option. Build Indexes Specify <code>true</code> to direct the <code>mongod</code> to build indexes. This setting corresponds to the <code>buildIndexes</code> <code>mongod</code> replica set configuration option. Add a Mongod Adds an additional <code>mongod</code> process as a replica set member.Adding a new <code>mongod</code> process also updates the list of processes in the Member Configuration section. You must configure the Version, Data Directory of the new process."},{"location":"WhalealPlatform/05-ManageDeployments/02-EditDeploymentConfiguration/#configure-your-replication-settings","title":"Configure your Replication Settings.","text":"<p>The Cluster Configuration section contains the following configuration options for the replica set:</p> <p></p> Setting Description Protocol Version Select the replication protocol version used by the replica set. This setting corresponds to the <code>protocolVersion</code> replica set configuration option. Chaining Allowed Specify <code>true</code> to allow secondary members to replicate from other secondary members. This setting corresponds to the <code>chainingAllowed</code> replica set configuration option. Write Concern Majority Journal Default Determines the behavior of <code>{w:\"majority\"}</code> write concern if the write concern does not explicitly specify the journal option <code>j</code>. This setting corresponds to the <code>writeConcernMajorityJournalDefault</code> replica set configuration option. Heartbeat Timeout (secs) Specify the number of seconds that the replica set members wait for a successful heartbeat from each other. This setting corresponds to the <code>heartbeatTimeoutSecs</code> replica set configuration option. Election Timeout (ms) Specify the time limit in milliseconds for detecting when a replica set's primary is unreachable. This setting corresponds to the <code>electionTimeoutMillis</code> replica set configuration option. CatchUp Timeout (ms) Specify the time limit in milliseconds for a newly elected primary to sync, or catch up, with the other replica set members that may have more recent writes. This setting corresponds to the <code>catchUpTimeoutMillis</code> replica set configuration option. CatchUp Takeover Delay (ms) Specify the time in milliseconds a node waits to initiate a catchup takeover after determining it is ahead of the current primary. This setting corresponds to the <code>catchUpTakeoverDelayMillis</code> replica set configuration option."},{"location":"WhalealPlatform/05-ManageDeployments/02-EditDeploymentConfiguration/#modify-advanced-configuration-options_1","title":"Modify Advanced Configuration Options.","text":"<p>The **Advanced Configuration ** section allows you to set MongoDB <code>runtime options</code> for each MongoDB process in your deployment.</p> <p>To add an option:</p> <ol> <li>Click Add Options.</li> </ol> <p></p> <ol> <li>Click Select and select the configuration option.</li> </ol> <p></p> <ol> <li> <p>Whaleal displays a context-sensitive input for configuring an acceptable value for the selected option.</p> </li> <li> <p>Click Confirm to add the selected option and its corresponding value to every process of the selected process type in the cluster.</p> </li> </ol>"},{"location":"WhalealPlatform/05-ManageDeployments/02-EditDeploymentConfiguration/#click-update_1","title":"Click Update.","text":""},{"location":"WhalealPlatform/05-ManageDeployments/02-EditDeploymentConfiguration/#sharded-cluster","title":"Sharded Cluster","text":""},{"location":"WhalealPlatform/05-ManageDeployments/02-EditDeploymentConfiguration/#in-the-operation-drop-down-list-next-to-the-deployed-cluster-click-cluster-modify_2","title":"In the Operation drop-down list next to the deployed cluster, click Cluster Modify.","text":""},{"location":"WhalealPlatform/05-ManageDeployments/02-EditDeploymentConfiguration/#modify-cluster-wide-settings_1","title":"Modify Cluster-Wide Settings.","text":"<p>From the Member Configuration section, click Shard Settings to open the shard configuration options. Whaleal lists each shard in the cluster and the <code>mongod</code> processes associated to that shard. Each shard process has the following options. You cannot modify options that are greyed out:</p> <p></p> Setting Description Member Select one of the following replica set member roles from the menu:<code>Default</code>: A data-bearing member of the replica set that can become the primary and vote in elections.<code>Hidden</code>: A data-bearing member of the replica set that can vote in elections. Corresponds to the <code>hidden</code> replica configuration option.<code>Delayed Hidden</code>: A data-bearing member of the replica set that can vote in elections. Corresponds to the <code>secondaryDelaySecs</code> and <code>hidden</code> replica configuration options. Hostname Select from the menu the host to which Whaleal Automation deploys the replica set member. The menu only lists hosts under Whaleal Automation. This hostname can be a hostname or an IPv4 address. Votes Specify the number of votes that the replica set member has during elections. This setting corresponds to the <code>votes</code> <code>mongod</code> replica set configuration option. Priority Specify the priority of the member during elections. Replica set members with a priority of <code>0</code> cannot become the primary and cannot trigger elections. This setting corresponds to the <code>priority</code> <code>mongod</code>] replica set configuration option. Delay Specify the number of seconds \"behind\" the primary member this member should \"lag\". This setting corresponds to the <code>secondaryDelaySecs</code> <code>mongod</code> replica set configuration option. Build Indexes Specify <code>true</code> to direct the <code>mongod</code> to build indexes. This setting corresponds to the <code>buildIndexes</code> <code>mongod</code> replica set configuration option. Add a Mongod Adds an additional <code>mongod</code> process as a replica set member.Adding a new <code>mongod</code> process also updates the list of processes in the Member Configuration section. You must configure the Version, Data Directory of the new process. <p>To add additional shards to the cluster:</p> <ol> <li>Click Add a Shard.</li> </ol> <p></p> <ol> <li>Under the Cluster Configuration section, set the following parameters for each <code>mongod</code> in the shard:</li> <li>Version</li> <li>Data Directory</li> <li>Log File</li> </ol>"},{"location":"WhalealPlatform/05-ManageDeployments/02-EditDeploymentConfiguration/#configure-each-configuration-server-in-your-cluster","title":"Configure Each Configuration Server in Your Cluster.","text":"<p>From the Member Configuration section, click Config Server Replica Set Settings to open the CSRS configuration options. Each config server replica set member has the following options:</p> <p></p> Setting Description Member Select one of the following replica set member roles from the menu:<code>Default</code>: A data-bearing member of the replica set that can become the primary and vote in elections.<code>Hidden</code>: A data-bearing member of the replica set that can vote in elections. Corresponds to the <code>hidden</code> replica configuration option.<code>Delayed Hidden</code>: A data-bearing member of the replica set that can vote in elections. Corresponds to the <code>secondaryDelaySecs</code> and <code>hidden</code> replica configuration options. Hostname Select from the menu the host to which Whaleal Automation deploys the replica set member. The menu only lists hosts under Whaleal Automation. This hostname can be a hostname or an IPv4 address. Port Specify the IANA port number for the <code>mongod</code> process. This setting corresponds to the <code>net.port</code> configuration file option. Defaults to <code>27017</code>.The <code>mongod</code> must have exclusive access to the specified port. If deploying multiple <code>mongod</code> processes to a single host, you must select a unique unused port for each process. Votes Specify the number of votes that the replica set member has during elections. This setting corresponds to the <code>votes</code> <code>mongod</code> replica set configuration option. Priority Specify the priority of the member during elections. Replica set members with a priority of <code>0</code> cannot become the primary and cannot trigger elections. This setting corresponds to the <code>priority</code> <code>mongod</code> replica set configuration option. Delay Specify the number of seconds \"behind\" the primary member this member should \"lag\". This setting corresponds to the <code>secondaryDelaySecs</code> <code>mongod</code> replica set configuration option. Build Indexes Specify <code>true</code> to direct the <code>mongod</code>] to build indexes. This setting corresponds to the <code>buildIndexes</code> <code>mongod</code> replica set configuration option. This setting corresponds to the <code>tags</code> <code>mongod</code> replica set configuration option. Add a Mongod Adds an additional <code>mongod</code> process as a replica set member.Adding a new <code>mongod</code> process also updates the list of processes in the Cluster Configuration section. You must configure the Version  and Data Directory of the new process."},{"location":"WhalealPlatform/05-ManageDeployments/02-EditDeploymentConfiguration/#configure-each-mongos-in-your-cluster","title":"Configure Each <code>mongos</code> in Your Cluster.","text":"<p>From the Member Configuration section, click Mongos Settings to open the <code>mongos</code> configuration options. Each <code>mongos</code> process has the following options:</p> <p></p> Setting Description Hostname Select from the menu the host to which Whaleal Automation deploys the <code>mongos</code>. The menu only lists hosts under Whaleal Automation. For complete documentation on adding servers to Whaleal Automation. This hostname can be a hostname or an IPv4 address. Port Specify the IANA port number for the <code>mongos</code> process. This setting corresponds to the <code>net.port</code> configuration file option. Defaults to <code>27017</code>.The <code>mongos</code> must have exclusive access to the specified port. If deploying multiple <code>mongos</code> processes to a single host, you must select a unique unused port for each process. Add a Mongos Click to add an additional <code>mongos</code> process."},{"location":"WhalealPlatform/05-ManageDeployments/02-EditDeploymentConfiguration/#configure-each-replica-set-in-your-cluster","title":"Configure Each Replica Set in your Cluster.","text":"<p>The Replication Settings section contains the following configuration options for each replica set in the cluster:</p> <p></p> Setting Description Protocol Version Select the replication protocol version used by the replica set. This setting corresponds to the <code>protocolVersion</code> replica set configuration option.For more information, see Replica Set Protocol Versions. Chaining Allowed Specify <code>true</code> to allow secondary members to replicate from other secondary members. This setting corresponds to the <code>chainingAllowed</code> replica set configuration option. Write Concern Majority Journal Default Determines the behavior of <code>{w:\"majority\"}</code> write concern if the write concern does not explicitly specify the journal option <code>j</code>. This setting corresponds to the <code>writeConcernMajorityJournalDefault</code>replica set configuration option. Heartbeat Timeout (secs) Specify the number of seconds that the replica set members wait for a successful heartbeat from each other. This setting corresponds to the <code>heartbeatTimeoutSecs</code> replica set configuration option. Election Timeout (ms) Specify the time limit in milliseconds for detecting when a replica set's primary is unreachable. This setting corresponds to the <code>electionTimeoutMillis</code> replica set configuration option. CatchUp Timeout (ms) Specify the time limit in milliseconds for a newly elected primary to sync, or catch up, with the other replica set members that may have more recent writes. This setting corresponds to the <code>catchUpTimeoutMillis</code>replica set configuration option. CatchUp Takeover Delay (ms) Specify the time in milliseconds a node waits to initiate a catchup takeover after determining it is ahead of the current primary. This setting corresponds to the <code>catchUpTakeoverDelayMillis</code> replica set configuration option."},{"location":"WhalealPlatform/05-ManageDeployments/02-EditDeploymentConfiguration/#set-any-advanced-configuration-options-for-your-mongodb-replica-set","title":"Set any advanced configuration options for your MongoDB replica set.","text":"<p>The Advanced Configuration Options section allows you to set MongoDB runtime options for each MongoDB process in your deployment.</p> <p>To add an option:</p> <ol> <li>Click Advanced Configuration.</li> </ol> <p></p> <ol> <li>Click Add Option and select the configuration option.</li> </ol> <p></p> <ol> <li> <p>Whaleal displays a context-sensitive input for configuring an acceptable value for the selected option.</p> </li> <li> <p>Click Confirm to add the selected option and its corresponding value to every process of the selected process type in the cluster.</p> </li> </ol>"},{"location":"WhalealPlatform/05-ManageDeployments/02-EditDeploymentConfiguration/#click-update_2","title":"Click Update","text":""},{"location":"WhalealPlatform/05-ManageDeployments/03-EditsReplicaSets/","title":"Edit a Replica Sets","text":""},{"location":"WhalealPlatform/05-ManageDeployments/03-EditsReplicaSets/#overview","title":"Overview","text":"<p>You can add, remove, and reconfigure members in a replica setdirectly in the Whaleal console.</p>"},{"location":"WhalealPlatform/05-ManageDeployments/03-EditsReplicaSets/#procedures","title":"Procedures","text":""},{"location":"WhalealPlatform/05-ManageDeployments/03-EditsReplicaSets/#add-a-replica-set-member","title":"Add a Replica Set Member","text":"<p>You must have an existing server to which to deploy the new replica set member. To add a member to an existing replica set, increasing the size of the set:</p> <ol> <li>Navigate to the Clusters view for your deployment.</li> </ol> <p>\u200b        a. If it is not already displayed, select your desired project from the MongoDB menu in the navigation bar.</p> <p>\u200b        b. If it is not already displayed, select your desired project from the Projects menu in the drop-down box options.</p> <p>\u200b        Click the Clusters view.</p> <ol> <li> <p>On the card with the replica set, click Cluster Modify.</p> </li> <li> <p>In Member Configuration, click Add+.</p> </li> </ol> <p></p> <ol> <li>In Hostname, select the host that you want to add as a new member of the replica set.</li> </ol> <p>Use the following procedure to add the host if it doesn't appear in the Hostname list:</p> <p>\u200b        a. In Hostname, select New Server.</p> <p>\u200b            If no hosts have yet been added to the project, the Hostname list does not appear. Click Server instead.</p> <p>\u200b        b. In the Server dialog, select your operating system and click Add Host.</p> <p>\u200b        c. Follow the instructions to install an Agent on the new host.</p> <ol> <li>Click Update.</li> </ol>"},{"location":"WhalealPlatform/05-ManageDeployments/03-EditsReplicaSets/#edit-a-replica-set-member","title":"Edit a Replica Set Member","text":"<ol> <li>Navigate to the Clusters view for your deployment.</li> </ol> <p>\u200b        a. If it is not already displayed, select your desired project from the MongoDB menu in the navigation bar.</p> <p>\u200b        b. If it is not already displayed, select your desired project from the Projects menu in the drop-down box options.</p> <p>\u200b        Click the Clusters view.</p> <ol> <li> <p>On the card with the replica set, click Cluster Modify.</p> </li> <li> <p>In Member Configuration, modify the settings for the replica set member that you want to edit.</p> </li> </ol> Votes Specify whether the replica set member votes in elections. A value of <code>1</code> indicates the member votes, while a value of <code>0</code> indicates that the member does not vote. Priority Specify the priority of the replica set member during elections. Non-voting members must have a priority of <code>0</code>. Build Indexes Specify whether the replica set member builds indexes. <p></p> <ol> <li>Click Update.</li> </ol>"},{"location":"WhalealPlatform/05-ManageDeployments/03-EditsReplicaSets/#remove-a-replica-set-member","title":"Remove a Replica Set Member","text":"<ol> <li>Navigate to the Clusters view for your deployment.</li> </ol> <p>\u200b        a. If it is not already displayed, select your desired project from the MongoDB menu in the navigation bar.</p> <p>\u200b        b. If it is not already displayed, select your desired project from the Projects menu in the drop-down box options.</p> <p>\u200b        Click the Clusters view.</p> <ol> <li> <p>On the card with the replica set, click Cluster Modify.</p> </li> <li> <p>In Member Configuration, to find the target mongod process, click the red delete button on the right.</p> </li> </ol> <p></p> <ol> <li>Click Update.</li> </ol>"},{"location":"WhalealPlatform/05-ManageDeployments/03-EditsReplicaSets/#edit-a-cluster-configuration","title":"Edit a Cluster Configuration","text":"<ol> <li>Navigate to the Clusters view for your deployment.</li> </ol> <p>\u200b        a. If it is not already displayed, select your desired project from the MongoDB menu in the navigation bar.</p> <p>\u200b        b. If it is not already displayed, select your desired project from the Projects menu in the drop-down box options.</p> <p>\u200b        Click the Clusters view.</p> <ol> <li> <p>On the card with the replica set, click Cluster Modify.</p> </li> <li> <p>Configure the replica set in Cluster Configuration.</p> </li> </ol> <p></p> <ol> <li>Click Update.</li> </ol>"},{"location":"WhalealPlatform/05-ManageDeployments/04-ShardedClusterOperations/","title":"Sharded Cluster Operations","text":""},{"location":"WhalealPlatform/05-ManageDeployments/04-ShardedClusterOperations/#add-a-shard-to-a-mongodb-cluster","title":"Add a Shard to a MongoDB Cluster","text":"<ol> <li>Navigate to the Clusters view for your deployment.</li> </ol> <p>\u200b    a. If it is not already displayed, select your desired project from the MongoDB menu in the navigation bar.</p> <p>\u200b    b. If it is not already displayed, select your desired project from the Projects menu in the drop-down box options.</p> <p>\u200b    Click the Clusters view.</p> <ol> <li> <p>On the card with the replica set, click Cluster Modify.</p> </li> <li> <p>In the Member Configuration section, add a shard.</p> </li> </ol> <p></p> <p>\u200b        a. Expand shard settings.</p> <p>\u200b        b. Click Add a Shard to add <code>mongod</code> processes to the shard.</p> <p>## Review and update settings for the new shard as needed</p> Setting Description Member <code>Ordinary member node</code>:  A data-bearing member of the replica set that can become the primary and vote in elections.<code>Hidden node</code>:  A data-bearing member of the replica set that can vote in elections. Corresponds to the <code>hidden</code> replica configuration option.<code>Hidden Delayed node</code> :  A data-bearing member of the replica set that can vote in elections. Corresponds to the <code>secondaryDelaySecs</code> and <code>hidden</code> replica configuration options. Hostname Select from the menu the host to which Whaleal Automation deploys the replica set member. The menu only lists hosts under Whaleal Automation. This hostname can be a hostname or an IPv4 address. Port Specify the IANA port number for the <code>mongod</code> process. This setting corresponds to the <code>net.port</code> configuration file option. Defaults to <code>27017</code>.The <code>mongod</code> must have exclusive access to the specified port. If deploying multiple <code>mongod</code> processes to a single host, you must select a unique unused port for each process. Votes Specify the number of votes that the replica set member has during elections. This setting corresponds to the <code>votes</code> <code>mongod</code> replica set configuration option. Priority Specify the priority of the member during elections. Replica set members with a priority of <code>0</code> cannot become the primary and cannot trigger elections. This setting corresponds to the <code>priority</code> <code>mongod</code> replica set configuration option. Delay Specify the number of seconds \"behind\" the primary member this member should \"lag\". This setting corresponds to the <code>secondaryDelaySecs</code> <code>mongod</code> replica set configuration option. Build Indexes Specify <code>true</code> to direct the <code>mongod</code>] to build indexes. This setting corresponds to the <code>buildIndexes</code> <code>mongod</code> replica set configuration option. This setting corresponds to the <code>tags</code> <code>mongod</code> replica set configuration option. <ol> <li>Click the Update to add the new shard to the cluster.</li> </ol>"},{"location":"WhalealPlatform/05-ManageDeployments/04-ShardedClusterOperations/#remove-a-shard-to-a-mongodb-cluster","title":"Remove a Shard to a MongoDB Cluster","text":"<ol> <li>Navigate to the Clusters view for your deployment.</li> </ol> <p>\u200b        a. If it is not already displayed, select your desired project from the MongoDB menu in the navigation bar.</p> <p>\u200b        b. If it is not already displayed, select your desired project from the Projects menu in the drop-down box options.</p> <p>\u200b        Click the Clusters view.</p> <ol> <li> <p>On the card with the replica set, click Cluster Modify.</p> </li> <li> <p>In the Member Configuration section, remove a shard.</p> </li> </ol> <p></p> <p>This operation needs to be performed with caution</p> <ol> <li>Click the Update to remove a  shard from the cluster.</li> </ol>"},{"location":"WhalealPlatform/05-ManageDeployments/05-StopManagingandorMonitoringOneDeployment/","title":"Stop Managing and/or Monitoring One Deployment","text":""},{"location":"WhalealPlatform/05-ManageDeployments/05-StopManagingandorMonitoringOneDeployment/#stop-management","title":"Stop management","text":"<p>If you do not want to use Whaleal to manage the cluster, you can remove the cluster from management.</p> <ol> <li>Navigate to the Clusters view for your deployment.</li> </ol> <p>\u200b        a. If it is not already displayed, select your desired project from the MongoDB menu in the navigation bar.</p> <p>\u200b        b. If it is not already displayed, select your desired project from the Projects menu in the drop-down box options.</p> <p>\u200b        Click the Clusters view.</p> <ol> <li>On the card with the cluster, click Remove from WAP.</li> </ol> <p></p> <ol> <li>Click the Confirm button in the pop-up window to confirm the removal</li> </ol>"},{"location":"WhalealPlatform/05-ManageDeployments/05-StopManagingandorMonitoringOneDeployment/#stop-monitoring","title":"Stop Monitoring","text":"<ol> <li>Navigate to the Clusters view for your deployment.</li> </ol> <p>\u200b        a. If it is not already displayed, select your desired project from the MongoDB menu in the navigation bar.</p> <p>\u200b        b. If it is not already displayed, select your desired project from the Projects menu in the drop-down box options.</p> <p>\u200b        Click the Clusters view.</p> <ol> <li>On the card with the cluster, click Turn off Monitoring.</li> </ol> <p></p> <ol> <li>Click the Confirm button in the pop-up window to confirm the removal</li> </ol>"},{"location":"WhalealPlatform/05-ManageDeployments/06-MongoDBOperation/","title":"MongoDB Operation","text":"<p>By managing MongoDB clusters with Whaleal, we can start, shut down, restart, and other operations on the managed clusters. By clicking on the UI interface, we can easily implement these operations. The following is a list of operations that can be performed on the cluster using Wahaleal.</p> <p></p>"},{"location":"WhalealPlatform/05-ManageDeployments/06-MongoDBOperation/#connect-to-this-instance","title":"Connect to this instance","text":"<ol> <li>check the Connect to this instance button</li> <li> <p>Select the connection method and click the corresponding button. The currently provided connection methods are shell,  java , and python.</p> </li> <li> <p>Modify the username and password in the MongoDB connection string to use it</p> </li> </ol>"},{"location":"WhalealPlatform/05-ManageDeployments/06-MongoDBOperation/#update-cluster-info","title":"Update Cluster Info","text":"<ol> <li>check the Update Cluster Info button</li> <li>Whaleal updates cluster information every 10 seconds or longer by default. If we want to obtain the cluster information of the current cluster, we can use the Update Cluster Info button to obtain the current cluster information.</li> </ol>"},{"location":"WhalealPlatform/05-ManageDeployments/06-MongoDBOperation/#startup","title":"Startup","text":"<p>When the cluster is in the close state, we can start the cluster through Startup button.</p>"},{"location":"WhalealPlatform/05-ManageDeployments/06-MongoDBOperation/#shutdown","title":"Shutdown","text":"<p>When the cluster is in the Health state, we can shut down the cluster through Shutdown button.</p>"},{"location":"WhalealPlatform/05-ManageDeployments/06-MongoDBOperation/#restart","title":"Restart","text":"<p>When the cluster is in the Health state, we can restart the cluster through Shutdown button.</p>"},{"location":"WhalealPlatform/05-ManageDeployments/06-MongoDBOperation/#rename","title":"Rename","text":"<p>If you want to change the cluster name displayed in WAP, click rename to change the cluster name, but only change the cluster name displayed in Whaleal.</p>"},{"location":"WhalealPlatform/05-ManageDeployments/06-MongoDBOperation/#version-modify","title":"Version Modify","text":"<p>Whaleal can upgrade and downgrade the managed clusters, but it cannot upgrade or downgrade across versions and needs to be operated step by step.</p>"},{"location":"WhalealPlatform/05-ManageDeployments/06-MongoDBOperation/#note","title":"note:","text":"<p>Upload the relevant versions of the MongoDB service packages needed during the upgrade and downgrade process to the WAP in advance through Settings&gt;MongoDB Packge in the navigation bar.</p>"},{"location":"WhalealPlatform/05-ManageDeployments/06-MongoDBOperation/#upgrade","title":"Upgrade:","text":"<p>Before upgrading, you need to upload the target MongoDB version and all versions involved in the upgrade process to WAP. The upgrade process is a step-by-step upgrade and cross-version upgrade is not allowed.</p>"},{"location":"WhalealPlatform/05-ManageDeployments/06-MongoDBOperation/#downgrade","title":"Downgrade:","text":"<p>Before downgrading, you need to upload the target MongoDB version and all versions involved in the upgrade process to WAP. The upgrade process is a step-by-step downgrade, and cross-version downgrade is not allowed.</p>"},{"location":"WhalealPlatform/05-ManageDeployments/06-MongoDBOperation/#logrotaate-startegy","title":"LogRotaate Startegy","text":"<p>The log is split once a day. You can configure the split time according to the options. The time used is the punctual time (UTC time)</p>"},{"location":"WhalealPlatform/05-ManageDeployments/06-MongoDBOperation/#convert-to-replste","title":"Convert to ReplSte","text":"<p>Slandalone architecture-specific operation options.</p>"},{"location":"WhalealPlatform/05-ManageDeployments/06-MongoDBOperation/#convert-to-sharded-cluster","title":"Convert to Sharded Cluster","text":"<p>Operation options specific to the Replica Set architecture.</p>"},{"location":"WhalealPlatform/06-Monitor/01-MonitoringInstructions/","title":"Monitoring Instructions","text":"<p>Whaleal can monitor more than 30 aspects of MongoDB, including host-level monitoring and MongoDB-level monitoring. Monitoring is enabled by default, and we can also turn off monitoring. If you need to turn off monitoring, first click MongoDB, enter the MongoDB List page, then select the project we need to operate, and then click the magnifying glass icon to find the target cluster. After finding the target cluster, find Turn off Monitoring in the drop-down box on the right side of the cluster, click it, and then click Confirm to turn off the monitoring of the cluster.</p>"},{"location":"WhalealPlatform/06-Monitor/01-MonitoringInstructions/#why-use-monitoring-mongodb","title":"Why use monitoring MongoDB?","text":""},{"location":"WhalealPlatform/06-Monitor/01-MonitoringInstructions/#performance-optimization","title":"Performance Optimization","text":"<ul> <li>Improved Query Performance: By tracking metrics like Opcounters, Latency, and ScanAndOrder, you can identify and optimize slow queries, ensuring faster response times.</li> <li>Resource Utilization: Monitoring CPU, Memory, and Disk IOPS helps in identifying resource bottlenecks and optimizing the allocation of system resources to maintain smooth operations.</li> </ul>"},{"location":"WhalealPlatform/06-Monitor/01-MonitoringInstructions/#reliability-and-availability","title":"Reliability and Availability","text":"<ul> <li>Early Issue Detection: Metrics such as Page Faults, Connections, and Asserts allow for the early detection of potential issues, preventing downtime and ensuring high availability.</li> <li>Replication Health: Monitoring Oplog Window and OplogSize is crucial for maintaining replication health and ensuring data redundancy, which is vital for disaster recovery.</li> </ul>"},{"location":"WhalealPlatform/06-Monitor/01-MonitoringInstructions/#scalability","title":"Scalability","text":"<ul> <li>Capacity Planning: By observing trends in metrics like System Memory, LogicalSize, and IndexSize, you can effectively plan for scaling your MongoDB deployment, whether vertically (adding more resources) or horizontally (adding more nodes).</li> <li>Load Balancing: System Network and Network metrics help in understanding network traffic patterns, allowing for better load distribution across the database cluster.</li> </ul>"},{"location":"WhalealPlatform/06-Monitor/01-MonitoringInstructions/#security","title":"Security","text":"<ul> <li>Unauthorized Access Detection: By monitoring Connections and Network activity, you can detect unusual patterns that might indicate security breaches or unauthorized access attempts.</li> <li>Data Integrity: Ensuring that backup and replication processes are functioning correctly through Oplog Window and Logical DataSize metrics helps maintain data integrity.</li> </ul>"},{"location":"WhalealPlatform/06-Monitor/01-MonitoringInstructions/#operational-efficiency","title":"Operational Efficiency","text":"<ul> <li>Automated Alerts and Troubleshooting: Setting up alerts based on key metrics (e.g., high CPU usage, excessive Page Faults) reduces the manual effort required to monitor the system and allows for quick troubleshooting.</li> <li>Efficient Resource Management: Continuous monitoring of resource usage (CPU, Memory, Disk IOPS) ensures that resources are used efficiently, preventing over-provisioning and under-utilization.</li> </ul>"},{"location":"WhalealPlatform/06-Monitor/01-MonitoringInstructions/#compliance-and-reporting","title":"Compliance and Reporting","text":"<ul> <li>Regulatory Compliance: Detailed monitoring provides necessary logs and audit trails for compliance with regulatory requirements.</li> <li>Internal Audits: Regular reporting on metrics such as Asserts, LockCondition, and Transactions helps in conducting internal audits to ensure adherence to operational standards.</li> </ul>"},{"location":"WhalealPlatform/06-Monitor/01-MonitoringInstructions/#user-experience","title":"User Experience","text":"<ul> <li>Enhanced User Experience: By ensuring low latency and high availability, monitoring directly contributes to a better user experience for applications relying on MongoDB.</li> <li>Proactive Issue Resolution: Early detection of issues through metrics like Page Faults, LockCondition, and Tickets allows for proactive resolution, minimizing the impact on end-users.</li> </ul> <p>For more information about specific monitoring indicators, please refer to Monitoring indicator details</p>"},{"location":"WhalealPlatform/06-Monitor/02-UsageMonitoring/","title":"Usage Monitoring","text":"<p>When using monitoring, configure the following three options according to your needs</p>"},{"location":"WhalealPlatform/06-Monitor/02-UsageMonitoring/#monitoring-time-period","title":"Monitoring time period","text":"<p>When using monitoring, we can choose the monitoring time period according to our needs. There are three default options, namely Real Time, Last 1 Day, and Last 7 Day. Of course, if we want to configure other time periods to view monitoring, we can also directly configure Start Time and End Time.</p> <p></p>"},{"location":"WhalealPlatform/06-Monitor/02-UsageMonitoring/#monitoring-granularity","title":"Monitoring granularity","text":"<p>In order to better observe the changes in certain indicators, we can configure different granularities.</p> <p></p>"},{"location":"WhalealPlatform/06-Monitor/02-UsageMonitoring/#monitoring-metrics","title":"Monitoring Metrics","text":"<p>If we focus on which indicators, we can select different indicators as needed, so that the entire monitoring page looks simpler and clearer.The selected indicator will appear in the box above the drop-down box. It is also very simple to delete the monitoring indicator. Just click the cross after the indicator in the box to delete the displayed indicator.</p> <p></p>"},{"location":"WhalealPlatform/06-Monitor/03-MonitoringIndicatorDetails/","title":"Monitoring Indicator Details","text":""},{"location":"WhalealPlatform/06-Monitor/03-MonitoringIndicatorDetails/#system-resource-metrics","title":"System Resource Metrics","text":"<ol> <li>CPU: Monitors the CPU usage to identify if the system is overloaded.</li> </ol> <ol> <li>Memory Swap: Tracks swap space usage. Excessive swapping can degrade performance.</li> </ol> <ol> <li>System Memory: Observes overall memory usage to ensure there\u2019s enough available for MongoDB operations.</li> </ol> <ol> <li>System Network: Monitors network throughput and latency to identify potential network bottlenecks.</li> </ol> <ol> <li>Disk IOPS: Measures input/output operations per second on the disk, indicating how quickly data is read from or written to the disk.</li> </ol> <ol> <li>DiskInfo: Provides detailed information about disk usage and health.</li> </ol>"},{"location":"WhalealPlatform/06-Monitor/03-MonitoringIndicatorDetails/#mongodb-specific-metrics","title":"MongoDB-specific Metrics","text":"<ol> <li>Opcounters: Tracks the number of operations (insert, query, update, delete, etc.) performed.</li> </ol> <ol> <li>Connections: Monitors the number of active client connections to ensure the system can handle the load.</li> </ol> <ol> <li>Page Faults: Measures the rate of page faults, indicating how often MongoDB needs to read data from disk into memory.</li> </ol> <ol> <li>Memory: Tracks MongoDB\u2019s internal memory usage, including how much memory is used by different components.</li> </ol> <ol> <li>Network: Monitors MongoDB network traffic to ensure data is being transmitted efficiently.</li> </ol> <ol> <li>Asserts: Tracks internal database assertions, which can indicate potential issues or bugs.</li> </ol>"},{"location":"WhalealPlatform/06-Monitor/03-MonitoringIndicatorDetails/#cache-metrics","title":"Cache Metrics","text":"<ol> <li>Cache Flow: Measures the flow of data into and out of the cache, indicating cache efficiency.</li> </ol> <ol> <li>Cache Usage: Monitors how effectively the cache is being utilized.</li> </ol>"},{"location":"WhalealPlatform/06-Monitor/03-MonitoringIndicatorDetails/#performance-metrics","title":"Performance Metrics","text":"<ol> <li>Latency: Measures the response time for queries, helping to identify performance bottlenecks.</li> </ol> <ol> <li>Tickets: Tracks the availability of tickets for read and write operations, indicating resource contention.</li> </ol> <ol> <li>Target Query: Monitors the performance of specific targeted queries.</li> </ol> <ol> <li>ScanAndOrder: Tracks operations where MongoDB must scan documents and order them in memory, which can be resource-intensive.</li> </ol> <ol> <li>CollectionSCAN: Measures the frequency of collection scans, which are less efficient than indexed queries.</li> </ol>"},{"location":"WhalealPlatform/06-Monitor/03-MonitoringIndicatorDetails/#document-and-data-metrics","title":"Document and Data Metrics","text":"<ol> <li>Document Info: Provides details about the number and size of documents.</li> </ol> <ol> <li>Deleted Document: Tracks the rate at which documents are deleted.</li> </ol> <ol> <li>Oplog Window: Monitors the size of the oplog window, crucial for replication lag and recovery.</li> </ol> <ol> <li>LogicalSize: Measures the logical size of the database, providing insight into data growth.</li> </ol> <ol> <li>OpenCursor: Tracks the number of open cursors, indicating active database operations.</li> </ol> <ol> <li>Logical DataSize: Measures the logical size of data stored in MongoDB.</li> </ol> <ol> <li>IndexSize: Tracks the size of indexes, impacting query performance.</li> </ol> <ol> <li>OplogSize: Monitors the size of the oplog, essential for replication health.</li> </ol>"},{"location":"WhalealPlatform/06-Monitor/03-MonitoringIndicatorDetails/#lock-and-transaction-metrics","title":"Lock and Transaction Metrics","text":"<ol> <li>LockCondition: Tracks lock contention within MongoDB, which can affect performance.</li> </ol> <ol> <li>DatabaseLock: Measures the time the database is locked for various operations.</li> </ol> <ol> <li>CollectionLock: Monitors lock contention at the collection level.</li> </ol> <ol> <li>Transaction Condition: Tracks transaction performance and conflicts.</li> </ol>"},{"location":"WhalealPlatform/07-BackupAndRestore/02-Restore/","title":"Restore","text":"<p>Backup data restore,  You can restore snapshot backup data to the current cluster or a specified cluster. If DDT is used for backup, you can restore it to any point in time during the backup period.</p> <p>To restore a deployment from a backup, select a snapshot or point in time from which you want to restore your database. Whaleal provides you with the files from which you can restore your database.</p> <p>You can restore a replica set, or all shards in a sharded cluster.</p> <p>You can restore a deployment from an existing snapshot or a specific point in time. For the point in time, you can specify a date and time.</p> <p>To restore your backup, use one of these options:</p> <ul> <li>Restore the files to another cluster using automation</li> <li>Restore the files to current cluster using automation</li> </ul> <p></p>"},{"location":"WhalealPlatform/07-BackupAndRestore/02-Restore/#restore_1","title":"Restore","text":"<p>To restore:</p> <ol> <li> <p>Navigate to the Backup &gt; Restore History tab.</p> </li> <li> <p>Click Restore.</p> </li> </ol>"},{"location":"WhalealPlatform/07-BackupAndRestore/02-Restore/#snapshot","title":"snapshot","text":"<p>If you choose to have Whaleal automation restore your backup, the Automation removes all existing data from the target hosts and replaces that data with new backup data from your snapshot.</p>"},{"location":"WhalealPlatform/07-BackupAndRestore/02-Restore/#point-in-time","title":"point in time","text":"<p>If you select point in time to restore to the specified point in time, you can restore to any point in time between the start of backup and the current point in time. However, the target of recovery cannot be the current cluster, You can only restore to a new cluster.</p>"},{"location":"WhalealPlatform/07-BackupAndRestore/02-Restore/#limitations","title":"Limitations","text":"<p>If you are restoring a sharded cluster, you must restore all shards. And the recovery target must be consistent with the source cluster architecture (number of fragments) and version. The restore process fails if you try to restore a single shard in a sharded cluster.</p>"},{"location":"WhalealPlatform/07-BackupAndRestore/02-Restore/#prerequisites","title":"Prerequisites","text":"<p>To perform automated restores:</p> <p>Install an MongoDB Agent installed on the source and all target hosts, and check that an MongoDB Agent on the target deployment can connect to all hosts in the target deployment.</p> <p>Potential Causes for Automated Restore Failure An automated restore can fail when certain storage settings of the backup's database and target database do not match:</p> <ul> <li>storage.engine</li> <li>storage.directoryPerDB</li> <li>storage.mmapv1.nsSize</li> <li>storage.mmapv1.smallFiles</li> <li>storage.wiredTiger.collectionConfig.blockCompressor</li> <li>storage.wiredTiger.engineConfig.directoryForIndexes</li> </ul> <p>An automated restore fails when you attempt to restore a single shard in a sharded cluster. If you are restoring a sharded cluster, you must restore all shards.</p>"},{"location":"WhalealPlatform/07-BackupAndRestore/02-Restore/#manual-restore","title":"Manual Restore","text":""},{"location":"WhalealPlatform/07-BackupAndRestore/02-Restore/#prerequisites_1","title":"Prerequisites","text":"<p>To perform manual restores, you must have the Backup Admin role in Whaleal.</p>"},{"location":"WhalealPlatform/07-BackupAndRestore/02-Restore/#restore-file-format","title":"Restore File Format","text":"<p>Whaleal provides each snapshot as an uncompressed (.tar) or compressed (.tar.gz) archive containing a complete copy of the data directory.</p> <p>Choosing compressed snapshots results in faster delivery, but requires sufficient space on the target host for both the compressed snapshot and its extracted database files.</p>"},{"location":"WhalealPlatform/07-BackupAndRestore/01-Backup/01-CreateRepository/","title":"Create Repository","text":"<p>The bacckup function of the WAP platform is implemented based on two methods: dump and DDT. mongodump is a toolkit provided by MongoDB, and DDT is a full-volume, full-volume + incremental, full-volume + real-time backup tool implemented by MongoDB Oplog. Provide users with all-round backup functions.</p>"},{"location":"WhalealPlatform/07-BackupAndRestore/01-Backup/01-CreateRepository/#backup-architecture-diagram","title":"Backup architecture diagram","text":""},{"location":"WhalealPlatform/07-BackupAndRestore/01-Backup/01-CreateRepository/#dump","title":"dump","text":""},{"location":"WhalealPlatform/07-BackupAndRestore/01-Backup/01-CreateRepository/#ddt","title":"DDT","text":""},{"location":"WhalealPlatform/07-BackupAndRestore/01-Backup/01-CreateRepository/#start-a-backup","title":"Start A Backup","text":""},{"location":"WhalealPlatform/07-BackupAndRestore/01-Backup/01-CreateRepository/#navigate-to-the-create-repository-page","title":"Navigate to the Create Repository page.","text":"<ol> <li>Find the Backup option in the menu bar, click Backup in the drop-down menu to enter the Backup page. </li> <li>Click Create Repository to start cluster backup.</li> </ol>"},{"location":"WhalealPlatform/07-BackupAndRestore/01-Backup/01-CreateRepository/#configure-backup-parameters","title":"Configure backup parameters","text":"Parameters Description Name Name of the backup policy. Type Backup type, optional values:ddt: Backup through backup programdump: Backup through the MongoDB tool mongodump. MongoDB Cluster MongoDB cluster to be backed up. DDT Host The host for deploy DDT, which must be in the DDT Project. MongoDB Host The host deploy MongoDB for used to store backup data. Storage Location Method of uploading backup S3 files (supports AWS S3 and Linode Object Storage). Task Snapshots Every Frequency of backing up data (every 1 day or every 7 days). Keep S3 File Days Number of days to keep the snapshot files in S3. Recover Data From Days Number of days to retain oplog incremental data (used for data recovery to a specific point in time), this number should be less than the snapshot file retention days. Cache Size Of 47019 Cache size setting for full MongoDB service. Cache Size Of 57019 Cache size setting for incremental MongoDB service. DDT Of Oplog JVM memory setting for incremental DDT backup Java service. DDT Of Full JVM memory setting for full DDT backup Java service. DDT Of Replay Oplog JVM memory setting for data recovery DDT Java service. dump_restore_work_num Number of collections dump &amp; restore should export in parallel restore_drop_collection Before restoring the collections from the dumped backup, drops the collections from the target database, optional values: 0, 1."},{"location":"WhalealPlatform/07-BackupAndRestore/01-Backup/01-CreateRepository/#view-backup-tasks","title":"View Backup Tasks","text":"Parameters Description Event Log View all log records throughout the life cycle of a backup task. Full MongoDB Cluster MongoDB for full backup data storage. Oplog MongoDB Cluster MongoDB for incremental Oplog backup data storage. DDT Host Name Server on which DDT is deployed. DDT MongoDB Name Server where full backup data and incremental Oplog backup data are deployed. Advance Configuration Configuration of maximum usage limit of backup resources. Task Log View the logs of each backup program in the backup task."},{"location":"WhalealPlatform/07-BackupAndRestore/01-Backup/02-Operations/","title":"Operations","text":""},{"location":"WhalealPlatform/07-BackupAndRestore/01-Backup/02-Operations/#backup-records","title":"Backup Records","text":""},{"location":"WhalealPlatform/07-BackupAndRestore/01-Backup/02-Operations/#backup","title":"BackUp","text":"<p>Displays a list of all snapshots, including snapshot files, creation time, expiration time, backup progress and other information of all nodes in the cluster. You can also view the running log of the entire backup cycle through Event Log.</p> <p></p> Parameters Description Sub Name Task Name. BackUp File Name The name and S3 download address of the cluster backup data file. DDT Task Name DDT backup task log details. Elapsed Time to generate backup snapshots. Items Total number of documents backed up by snapshots. Progress Progress percentage. Create Time Snapshot file creation time. Transfered Backup file size."},{"location":"WhalealPlatform/07-BackupAndRestore/01-Backup/02-Operations/#restore","title":"Restore","text":"<p>A list of backup data recovery tasks displays all backup and recovery operation records, and contains detailed information about specific tasks, including task execution time, task execution log, etc.</p> <p></p> Parameters Description Sub Name Task Name. BackUp File Name None DDT Task Name DDT restore task log details. Elapsed Time to generate restore snapshots. Items Total number of documents restore up by snapshots. Progress progress percentage. Create Time Snapshot file creation time. Transfered None"},{"location":"WhalealPlatform/07-BackupAndRestore/01-Backup/02-Operations/#update","title":"update","text":"<p>Update task status. Get the latest backup and restore tasks and task status.</p>"},{"location":"WhalealPlatform/07-BackupAndRestore/01-Backup/02-Operations/#take-a-snapshot","title":"Take a Snapshot","text":"<p>Restart the new snapshot task and generate a new snapshot. Specific details can be viewed in Backup Records.</p>"},{"location":"WhalealPlatform/07-BackupAndRestore/01-Backup/02-Operations/#stop","title":"Stop","text":"<p>Stop the backup task.</p>"},{"location":"WhalealPlatform/07-BackupAndRestore/01-Backup/02-Operations/#delete","title":"Delete","text":"<p>Delete backup policies and clarify all backup data files.</p>"},{"location":"WhalealPlatform/07-BackupAndRestore/01-Backup/02-Operations/#rebuild","title":"Rebuild","text":"<p>Rebuild backup tasks and recreate backup snapshots.</p>"},{"location":"WhalealPlatform/07-BackupAndRestore/01-Backup/02-Operations/#edit","title":"Edit","text":"<p>Modify the backup policy.</p>"},{"location":"WhalealPlatform/08-Security/01-ConfigureFirewalltoAccessWhaleal/","title":"Firewall Configuration","text":"<p>In order to ensure that WAP services and their components can run smoothly and interact effectively, appropriate ports must be opened for communication and data exchange. WAP services involve multiple key components, including WAP applications and WAP agents, which connect and transmit data through network ports.</p> <p>For firewall configuration, please refer to:</p> <ul> <li>HardwareAndSoftwareRequirements</li> </ul>"},{"location":"WhalealPlatform/08-Security/03-SecureMongoDBDeploymentswithAuthentication/01-MongoDBAccessControl/","title":"Configure MongoDB Authentication and Authorization","text":"<p>Your  MongoDB deployment can use the access control mechanisms described on this page. You can specify authentication settings when you add a deployment. After you add a deployment, you can edit the security settings.</p> <p>If your deployment uses access control, the WAP Agent must authenticate to the deployment as a MongoDB user with appropriate access permissions. Enable and configure authentication through the WAP application.</p>"},{"location":"WhalealPlatform/08-Security/03-SecureMongoDBDeploymentswithAuthentication/01-MongoDBAccessControl/#precautions","title":"Precautions","text":"<p>After enabling access control, you must create a MongoDB user so that clients can access your database.</p> <p>By default, WAP automatically creates a user for WAP Agent. WAP Agent can manage other users. Therefore, the first user you create can have any role.</p>"},{"location":"WhalealPlatform/08-Security/03-SecureMongoDBDeploymentswithAuthentication/01-MongoDBAccessControl/#access-control-mechanism","title":"Access control mechanism","text":""},{"location":"WhalealPlatform/08-Security/03-SecureMongoDBDeploymentswithAuthentication/01-MongoDBAccessControl/#scram-sha-1-and-scram-sha-256","title":"SCRAM-SHA-1 and SCRAM-SHA-256","text":"<p>In the following table, the default authentication mechanism for the release series is marked with \"\u2713\"</p> <p>and acceptable authentication mechanisms are marked with \"*\"</p> MongoDB Release Series SCRAM-SHA-1 SCRAM-SHA-256 5.x.x * \u2713 4.4.x * \u2713 4.2.x * \u2713 4.0.x * \u2713 <p>To enable SCRAM-SHA-1 or SCRAM-SHA-256 for your WAP project, complete the following tasks:</p> <ul> <li>Enable Username and Password Authentication for your WAP Project.</li> </ul>"},{"location":"WhalealPlatform/08-Security/03-SecureMongoDBDeploymentswithAuthentication/01-MongoDBAccessControl/#x509","title":"X.509","text":"<p>MongoDB supports X.509 certificate authentication for use with a secure TLS connection. The X.509 client authentication allows clients to authenticate to servers with certificates rather than with a username and password.</p> <p>To enable X.509 authentication for your WAP project, complete the following tasks:</p> <ul> <li>Enable x.509 Authentication for your WAP Project.</li> </ul> <p>You can also use X.509 certificates for membership authentication for the processes that WAP monitors.</p>"},{"location":"WhalealPlatform/08-Security/03-SecureMongoDBDeploymentswithAuthentication/02-EnableUsernamePasswordAuthentication/","title":"Enable Username and Password Authentication for your WAP Project","text":""},{"location":"WhalealPlatform/08-Security/03-SecureMongoDBDeploymentswithAuthentication/02-EnableUsernamePasswordAuthentication/#overview","title":"Overview","text":"<p>WAP enables you to configure the Authentication Mechanisms that all clients, including the WAP Agents, use to connect to your MongoDB deployments. </p> <p>MongoDB users can use usernames and passwords to authenticate themselves against a MongoDB database.</p> MongoDB Version Default authentication mechanism MongoDB 4.0 and later Salted Challenge Response Authentication Mechanism (SCRAM) using the SHA-1 and SHA-256 hashing algorithms (<code>SCRAM-SHA-1</code> and <code>SCRAM-SHA-256</code>)."},{"location":"WhalealPlatform/08-Security/03-SecureMongoDBDeploymentswithAuthentication/02-EnableUsernamePasswordAuthentication/#scram-sha-1-and-scram-sha-256","title":"SCRAM-SHA-1 and SCRAM-SHA-256","text":"<p>SCRAM-SHA-1 and SCRAM-SHA-256are IETF standards that define best practice methods for implementation of challenge-response mechanisms for authenticating users with passwords.</p> <p><code>SCRAM-SHA-1</code> and <code>SCRAM-SHA-256</code> verify supplied user credentials using the user's name, password and authentication database. The authentication database is the database where the user was created.</p>"},{"location":"WhalealPlatform/08-Security/03-SecureMongoDBDeploymentswithAuthentication/02-EnableUsernamePasswordAuthentication/#considerations","title":"Considerations","text":"<p>This tutorial describes how to enable Username and Password authentication for your WAP MongoDB deployment.</p>"},{"location":"WhalealPlatform/08-Security/03-SecureMongoDBDeploymentswithAuthentication/02-EnableUsernamePasswordAuthentication/#procedure","title":"Procedure","text":"<p>This procedure describes how to configure and enable username and password authentication when using Automation.</p>"},{"location":"WhalealPlatform/08-Security/03-SecureMongoDBDeploymentswithAuthentication/02-EnableUsernamePasswordAuthentication/#enable-password-authentication","title":"Enable Password Authentication","text":"<ol> <li> <p>Click MongoDB in the left navigation bar</p> </li> <li> <p>Select the Cluster Name you want to configure.</p> </li> </ol> <p></p> <ol> <li> <p>Click Safety Management</p> </li> <li> <p>Click Auth</p> </li> </ol> <p></p> <ol> <li> <p>Click Authentication management,</p> </li> <li> <p>Select Account and password and CA certificate for authLevel</p> </li> <li> <p>Finally click Confirm</p> </li> </ol> <p></p> <p>Enable password authentication. If there is no user, you need to create a user Please refer to:ManageMongoDBUsersandRoles</p>"},{"location":"WhalealPlatform/08-Security/03-SecureMongoDBDeploymentswithAuthentication/03-EnableX509Authentication/","title":"Enable CA Certificate Authentication for your WAP Project","text":"<p>WAP enables you to configure the Authentication Mechanisms that all clients, including the WAP Agents, use to connect to your MongoDB deployments. </p> <p>MongoDB supports x.509 client and member certificate authentication for use with a secure TLS/SSL connection. </p>"},{"location":"WhalealPlatform/08-Security/03-SecureMongoDBDeploymentswithAuthentication/03-EnableX509Authentication/#prerequisites","title":"Prerequisites","text":"<p>A full description of Transport Layer Security, public key infrastructure, X.509 certificates, and Certificate Authorities exceeds the scope of this tutorial. This tutorial assumes prior knowledge of TLS and access to valid X.509 certificates.</p>"},{"location":"WhalealPlatform/08-Security/03-SecureMongoDBDeploymentswithAuthentication/03-EnableX509Authentication/#procedures","title":"Procedures","text":"<p>These procedures describe how to configure and enable CA Certificate authentication when using Automation. </p> <p>Enable CA client certificate authentication for your WAP project</p> <ol> <li> <p>Click MongoDB in the left navigation bar</p> </li> <li> <p>Select the Cluster Name you want to configure.</p> </li> </ol> <p></p> <ol> <li> <p>Click Safety Management</p> </li> <li> <p>Click Auth</p> </li> </ol> <p></p> <ol> <li> <p>Click Authentication management,</p> </li> <li> <p>Select Account and password and CA certificate for authLevel</p> </li> <li> <p>Finally click Confirm</p> </li> </ol> <p></p> <p>If there is no user after enabling CA authentication, you need to create a mongodb user. Please refer to:ManageMongoDBUsersandRoles</p>"},{"location":"WhalealPlatform/08-Security/03-SecureMongoDBDeploymentswithAuthentication/04-ManageMongoDBUsersandRoles/","title":"Manage MongoDB Users and Roles","text":"<p>With access control enabled, clients must authenticate to the MongoDB process as MongoDB users. Once authenticated, these users only have privileges granted by their assigned roles. You can assign MongoDB's built-in roles to a user as well as custom roles.</p>"},{"location":"WhalealPlatform/08-Security/03-SecureMongoDBDeploymentswithAuthentication/04-ManageMongoDBUsersandRoles/#enter-the-user-management-page","title":"Enter the user management page","text":"<ol> <li>Click MongoDB in the left navigation bar</li> <li>Select the cluster name to configure</li> <li>Click Safety Management</li> <li>Click User</li> </ol> <p>WAP currently does not support deleting mongodb users or modifying mongodb user information</p> <p>wapAdamin user is the agent management user and will be created by default</p>"},{"location":"WhalealPlatform/08-Security/03-SecureMongoDBDeploymentswithAuthentication/04-ManageMongoDBUsersandRoles/#add-a-mongodb-user","title":"Add a MongoDB User","text":"<ol> <li> <p>Click on mongodb</p> </li> <li> <p>Select the Cluster Name you want to configure.</p> </li> </ol> <p></p> <ol> <li> <p>Click Safety Management</p> </li> <li> <p>Click User</p> </li> <li> <p>Click Add User</p> </li> </ol> <p></p> <ol> <li> <p>Configure username and password</p> </li> <li> <p>You can also click generation to quickly generate a secure password. Note: Remember to copy and save the password after generating it.</p> </li> </ol> <p></p> <ol> <li> <p>Configure authentication repository and roles</p> </li> <li> <p>db: Fill in the mongodb authentication library</p> </li> <li> <p>role: Select the user's role. Different roles have different permissions.</p> </li> </ol> <p></p> <ol> <li> <p>Select an Verification Mechanism</p> </li> <li> <p>Selectable SCRAM-SHA-1 or SCRAM-SHA-256</p> </li> </ol> <p></p> <ol> <li> <p>Configuring Authentication Restriction</p> <ul> <li> <p>clientSource: restricts which addresses this user can authenticate and use the given roles.</p> </li> <li> <p>serverAddress: restricts the addresses this user can authenticate and has the given roles.</p> </li> </ul> <p></p> </li> <li> <p>After the configuration is complete, click confirm</p> </li> </ol> <p></p>"},{"location":"WhalealPlatform/08-Security/03-SecureMongoDBDeploymentswithAuthentication/05-ConfigureandDeployAuditing/","title":"Configure and Deploy Auditing","text":"<p>The WAP platform supports the MongoDB community version to enable the Deploy Auditing function to record key information in detail, including user operations, request methods, cluster operations, user logins and other important content. These records provide administrators with a comprehensive data view to promptly identify any potential security risks or abnormal behaviors.</p>"},{"location":"WhalealPlatform/08-Security/03-SecureMongoDBDeploymentswithAuthentication/05-ConfigureandDeployAuditing/#go-to-the-audit-start-page","title":"Go to the audit start page","text":"<ol> <li> <p>Click MongoDB in the left navigation bar</p> </li> <li> <p>Select the Cluster Name for which auditing needs to be enabled</p> </li> <li> <p>Click Safety Management</p> </li> <li> <p>Click Audit</p> </li> </ol> <p></p> <p>Notice</p> <ol> <li>Only MongoDB community versions are supported</li> <li>Enabling this function generates a large number of MongoDB logs</li> </ol>"},{"location":"WhalealPlatform/08-Security/03-SecureMongoDBDeploymentswithAuthentication/05-ConfigureandDeployAuditing/#enable-audit-function-log","title":"Enable audit function log","text":"<ol> <li> <p>Click on mongodb</p> </li> <li> <p>Select the Cluster Name you want to configure.</p> </li> </ol> <p></p> <ol> <li> <p>Click Safety Management</p> </li> <li> <p>Click Audit</p> </li> </ol> <p></p> <ol> <li>Click Audit Enable and select yes</li> </ol> <p></p> <p>After opening the audit log, you can view the specific content on the audit page. Please see audit</p>"},{"location":"WhalealPlatform/09-Alert/01-HostAlert/","title":"Host Alert","text":"<p>When Whaleal is used to manage a host for the first time, Whaleal detects that the host is a new host and initializes it. The alarm mode directly inherits the alarm indicators in the current Project. If you want to configure different alarm indicators in the project, you can select the host of the server in the Host drop-down box in Host Alert and configure it separately.</p>"},{"location":"WhalealPlatform/09-Alert/01-HostAlert/#select-project","title":"Select Project","text":"<ol> <li>Click Alert in the navigation bar.</li> <li>Click Host Alert on the Alert Message page.</li> <li>In the host drop-down box, select the server for which you want to configure an alarm.</li> </ol>"},{"location":"WhalealPlatform/09-Alert/01-HostAlert/#indicator-configuration","title":"Indicator Configuration","text":"<p>After selecting the target hsot, the configuration options shown in the following picture may appear.</p> <p></p> <p>Configuration items\uff1a</p> Parameters Description Alert Strategy Type Time interval: To count indicators over a period of time, you need to configure the start time and end time in Statistics Granularity/S. Continuous Time: Configure the indicator statistics within a continuous time, which counts the indicator value at the current time. If Item Configure specific Alert indicators here Statistics Granularity/S Configure the granularity of statistics. If the granularity is too large, you may ignore the fact that the Alert indicator is too high at a certain point in time. Trigger Condition Configure indicator values according to plan\"&gt;\",\"&lt;\",\"=\",\"&gt;=\" ,or \"&lt;=\". Trigger Value Alert trigger value. When the Alert indicator value configured in the If Item reaches this value, an alarm will be triggered. Trigger Count The number of times the alarm is triggered within the time configured in then Alert Frequency/M then Alert Frequency/M Control alarm frequency"},{"location":"WhalealPlatform/09-Alert/01-HostAlert/#send-alerts","title":"Send alerts","text":"<p>When the alarm value is triggered, we can see the current alarm in open Alert, and we can search in MSG or configure the time interval to view the alarm within a period of time.</p> <p></p> <p>Alert will also send the alert to a specific platform through the information configured in the alert platform configured in Groups in the Project. For the configuration process, refer to Project Alert.</p>"},{"location":"WhalealPlatform/09-Alert/02-MongoDBAlert/","title":"MongoDB Alert","text":"<p>When you use Whaleal to manage a host for the first time, Whaleal will detect that the host is a new host and initialize it. The alarm method directly inherits the alarm indicators in the current project. If you want to configure different alarm indicators in the project, you can select the host where the server is located in the MongoDB drop-down box in MongoDB Alert and configure it separately.</p>"},{"location":"WhalealPlatform/09-Alert/02-MongoDBAlert/#select-project","title":"Select Project","text":"<ol> <li>Click Alert in the navigation bar.</li> <li>Click MongoDB Alert on the Alert Message page.</li> <li>In the MongoDB drop-down box, select the server for which you want to configure an alarm.</li> </ol>"},{"location":"WhalealPlatform/09-Alert/02-MongoDBAlert/#indicator-configuration","title":"Indicator Configuration","text":"<p>After selecting the target hsot, the configuration options shown in the following picture may appear.</p> <p></p> <p>Configuration items\uff1a</p> Alert Strategy Type Time interval: To count indicators over a period of time, you need to configure the start time and end time in Statistics Granularity/S. Continuous Time: Configure the indicator statistics within a continuous time, which counts the indicator value at the current time. If Item Configure specific Alert indicators here Statistics Granularity/S Configure the granularity of statistics. If the granularity is too large, you may ignore the fact that the Alert indicator is too high at a certain point in time. Trigger Condition Configure indicator values according to plan\"&gt;\",\"&lt;\",\"=\",\"&gt;=\" ,or \"&lt;=\". Trigger Value Alert trigger value. When the Alert indicator value configured in the If Item reaches this value, an alarm will be triggered. Trigger Count The number of times the alarm is triggered within the time configured in then Alert Frequency/M then Alert Frequency/M Control alarm frequency"},{"location":"WhalealPlatform/09-Alert/02-MongoDBAlert/#send-alerts","title":"Send alerts","text":"<p>When the alarm value is triggered, we can see the current alarm in open Alert, and we can search in MSG or configure the time interval to view the alarm within a period of time.</p> <p></p> <p>Alert will also send the alert to a specific platform through the information configured in the alert platform configured in Groups in the Project. For the configuration process, refer to Project Alert.</p>"},{"location":"WhalealPlatform/09-Alert/03-ProjectAlert/","title":"Project Alert","text":"<p>When using Whaleal to manage a MongoDB cluster, you can configure cluster alerts based on specific metrics. Alerts can be sent to DingTalk, Lark, or to a custom alert platform via Webhook.</p>"},{"location":"WhalealPlatform/09-Alert/03-ProjectAlert/#configuration-steps","title":"Configuration steps","text":"<ol> <li>Click Project in the left navigation bar of the Whaleal platform</li> <li>Click on the target item</li> <li>There are three types of police alert icons in Group. DingTalk and Lark configurations require the use of built-in tokens and salts\uff0cand Webhook.</li> </ol>"},{"location":"WhalealPlatform/09-Alert/03-ProjectAlert/#lark","title":"Lark","text":"<ol> <li> <p>Enter a Lark group.</p> </li> <li> <p>Click the three dots in the upper right corner of the group.</p> </li> </ol> <p></p> <ol> <li> <p>Add a bot</p> </li> <li> <p>Click Bots</p> <p></p> </li> <li> <p>Click Add Bot</p> <p></p> </li> <li> <p>Click Custom Bot</p> <p></p> </li> <li> <p>Edit Bot Name and Description</p> <p></p> </li> <li> <p>Configure the key to use \"_\" to connect</p> <p></p> </li> <li> <p>Configure the key spliced in step 5 in the Project.</p> <p></p> </li> </ol> <p>After the configuration is complete, click Alert Setting in the left navigation bar to configure the alarm trigger values and trigger methods of different indicators according to Host Alert, MongoDB Alert or Project.</p> <p></p>"},{"location":"WhalealPlatform/09-Alert/03-ProjectAlert/#dingtalk","title":"DingTalk","text":"<ol> <li> <p>Enter a DingTalk group.</p> </li> <li> <p>Click the three dots in the upper right corner of the group.</p> </li> </ol> <p></p> <ol> <li> <p>Add a bot</p> </li> <li> <p>Click Bots</p> <p></p> </li> <li> <p>Click Add Bot</p> <p></p> </li> <li> <p>Select Custom Bot</p> <p></p> </li> <li> <p>Edit Bot Name and Security Setting.</p> <p></p> </li> <li> <p>Check the Bot you just created, then copy the access_token after the Webhook link and concatenate it with the value of Additional Signature in Security Setting using \"_\".</p> <p></p> </li> <li> <p>Configure the key spliced in step 5 in the Project.</p> <p></p> </li> </ol> <p>After the configuration is complete, click Alert Setting in the left navigation bar to configure the alarm trigger values and trigger methods of different indicators according to Host Alert, MongoDB Alert or Project.</p> <p></p>"},{"location":"WhalealPlatform/09-Alert/03-ProjectAlert/#webhook","title":"WebHook","text":"<p>Webhook configuration configures an alarm Post Url, Webhook sends the alarm to this Url</p>"},{"location":"WhalealPlatform/10-Diagnose/01-ClusterInfo/","title":"Cluster Info","text":""},{"location":"WhalealPlatform/10-Diagnose/01-ClusterInfo/#select-cluster","title":"Select Cluster","text":"<p>Select info from Diagnose in the left navigation bar, and select the cluster name you want to view from the Cluster drop-down box on this page.</p> <p>We can view the cluster information here, including cluster status, MongoDB version information, and node health status</p> <p>Cluster Info:</p> Cluster Name Current cluster name Status The current state of the cluster Project Projects to which the cluster belongs Enable Monitoring Whether to enable monitoring Nodes Number of cluster nodes Authentication Mechanism The auth type of the current cluster Version MongoDB version information for the cluster FCV Feature Compatibility Version TLS/SSL TLS/SSL status Cluster Member Configuration Cluster Member Configuration is hostname or IP <p>Node Info:</p> <p>The left side of the node is the node information, and the right side is the monitoring.</p> <p>In the Operation drop-down box, you can operate the process of the node, including Update Node Information, Startup, ShutDown, Restart. These operations are only effective for the current node, not for the entire cluster.</p> <p>Clicking Monitor will jump to the monitoring page of the node, where you can see detailed monitoring indicators.</p> <p>Click Perforance to jump to the Perforance page of the node. For details, refer to Performance</p>"},{"location":"WhalealPlatform/10-Diagnose/01-ClusterInfo/#replicasetshard","title":"ReplicaSet/shard","text":"<p>In the ReplicaSet/shard cluster, there are two drop-down boxes: ReplicaSets Info and Node State. ReplicaSets Info contains the configuration information of Shards and Config Server in Replica Set or Shard, and Node State contains the information of each node in the cluster.</p>"},{"location":"WhalealPlatform/10-Diagnose/02-ClusterHealth/","title":"Cluster Health","text":"<p>Quick diagnosis</p> <p>Quick diagnosis includes the latency of both the WAP platform and agent hosts (WhalealLag), basic information of the hosts (HostInfo), more detailed real-time host resource utilization (RealHostInfo), basic information of MongoDB instances (MongoInfo), and more detailed real-time MongoDB instance information (RealMongoInfo). These pieces of information can assist in evaluating the performance, availability, and health status of MongoDB, thereby enabling appropriate optimization and adjustment measures.</p> <p>Start diagnosis</p> <p>After selecting the Cluster Name and Node Name, click Start Diagnose Session to start diagnosing the node.</p> <p></p> <p>After clicking Start Diagnose Session, the diagnosis node may take some time, please be patient.</p> <p>After the diagnosis is completed, a pop-up window will pop up saying End of Diagnosis!</p> <p></p> <p>Diagnose result</p> <p></p> <p></p> <p>The indicators in the Diagnose result are problematic indicators and need to be checked in detail.</p>"},{"location":"WhalealPlatform/10-Diagnose/03-Performance/","title":"Performance","text":"<p>Performance real-time monitoring can track and record the performance indicators of the MongoDB database system in real time. Through real-time monitoring, administrators can discover potential performance problems in a timely manner and take corresponding measures for optimization to ensure that the database system can continue to run efficiently.</p> <ol> <li>Select your cluster and cluster nodes</li> <li>Click Real-time Diagnosis</li> </ol> <p></p> <p>Monitoring comparison</p> <p>You can view the comparison of monitoring indicators of different nodes in a cluster.</p> <p></p> <ol> <li>Click Monitor Comparison</li> <li>You can choose the time range, node and indicator type for monitoring</li> </ol> <p></p> <p></p>"},{"location":"WhalealPlatform/10-Diagnose/04-LogVis/","title":"LogVis","text":"<p>Before using LogVis, you need to configure S3 storage in the settings in advance</p> <p>LogVis can view the slow query statistics in the logs within a certain period of time. To view the statistics, follow the steps below:</p> <ol> <li>Select Cluster Name and Node Name, then click the Analyze button.</li> </ol> <p></p> <ol> <li>Wait for a while and click the magnifying glass icon to view the analysis results</li> </ol> <p></p>"},{"location":"WhalealPlatform/10-Diagnose/04-LogVis/#connectionlist","title":"ConnectionList","text":"<p>In ConnectionList, you can see which nodes the cluster is connected to and count the number of connections.</p> <p></p>"},{"location":"WhalealPlatform/10-Diagnose/04-LogVis/#statistical-information","title":"Statistical information","text":"<p>In Statistical information, view the slow query statistics of each collection in the collection, including the number of slow queries, the average time of slow queries, and the longest/shortest time statistics of slow queries.</p> <p></p>"},{"location":"WhalealPlatform/10-Diagnose/04-LogVis/#slow-query-information","title":"Slow query information","text":"<p>In Slow query information, the collection name is displayed above. Click the colored dot in front of the collection name to control whether to display the slow query of the table. Then click the colored dot in the figure. The color dot with the same color as the collection name is a slow query of the collection. After clicking, the slow query will appear below. Click Click To View to view the analysis information of the slow query.</p> <p></p> <p></p>"},{"location":"WhalealPlatform/10-Diagnose/05-ExploreData/","title":"ExploreData","text":"<p>Explain Plan (execution plan) is used to explain the execution method and optimization strategy of query statements. By analyzing the execution plan, administrators can understand the execution of the query, discover potential performance bottlenecks, and optimize it. You can optimize query statements, create appropriate indexes, or adjust the storage structure of the collection based on the execution plan to improve query efficiency and overall performance.</p> <ol> <li>Select Cluster Name</li> </ol> <p></p> <ol> <li>Select a database and click on it to enter the database.</li> </ol> <p></p> <ol> <li>Select a collection and click on it to enter the collection.</li> </ol> <p></p> <ol> <li>Fill in the statement to be executed in the FILTER, and then click the explain button</li> </ol> <p></p>"},{"location":"WhalealPlatform/10-Diagnose/05-ExploreData/#explain-result","title":"Explain Result","text":"<p>Visual Tree:Formatted explain result</p> <p></p> <p>Raw Json:Complete explain result</p> <p></p>"},{"location":"WhalealPlatform/11-Audit/01-Audit/","title":"Audit List","text":"<p>The WAP platform supports the MongoDB community version to enable the Deploy Auditing function to record key information in detail, including user operations, request methods, cluster operations, user logins and other important content. These records provide administrators with a comprehensive data view to promptly identify any potential security risks or abnormal behaviors.</p> <p>To enable Audit for your mongodb cluster, please refer to:ConfigureandDeployAuditing</p>"},{"location":"WhalealPlatform/11-Audit/01-Audit/#contents-introduction","title":"Contents Introduction","text":""},{"location":"WhalealPlatform/11-Audit/01-Audit/#steps-to-access-the-page","title":"Steps to access the page","text":"<p>Click Audit on the right menu bar</p> <p></p>"},{"location":"WhalealPlatform/11-Audit/01-Audit/#selection-feature-introduction","title":"Selection feature introduction","text":""},{"location":"WhalealPlatform/11-Audit/01-Audit/#_1","title":"Audit List","text":"Parameters Description MSG Search for the group you want to search Time Range Select time range progress selection search content Member User selects the platform user wants to view the accounting journal level Selection of accounting journal levels, from 0 to 4"},{"location":"WhalealPlatform/11-Audit/01-Audit/#dashboard-page","title":"Dashboard page","text":"Parameters Description User operation Records user account operations, deletions, modifications, etc. Request Mode Record platform request operations, including web and API MongoDB Cluster Operation Records include cluster update, delete and other operations Login Record user login information"},{"location":"WhalealPlatform/11-Audit/01-Audit/#log-information","title":"Log information","text":"Parameters Description High-risk Operation High-risk platform operations, including service restart, cluster modification, Agent downtime, etc. Normal Operation Contains all normal operation information, which can be exported to a csv file locally"},{"location":"WhalealPlatform/12-Account/01-PersonalCenter/","title":"Personal Center","text":"<p>The user center contains the user's information</p> <p>You can modify your personal information including email, phone number, etc.</p> <p>View current personal information</p> <ol> <li> <p>Click on the user name on the right</p> </li> <li> <p>Click Account</p> </li> </ol> <p></p> Parameters Description Name The name of the currently logged in user Email Email bound to the current user,After configuring the alarm in Whaleal, the alarm notification will be sent to your personal mailbox simultaneously. Phone The mobile phone number bound to the current user,After configuring the alarm in Whaleal, the alarm notification will be sent to your personal mobile phone synchronously in the form of SMS. Create Time Current user creation time Update Time The time when the current user's information was last modified DingTalk\u3001Lark\u3001Webhook Configure DingTalk, Lark, and Webhook to obtain alarm information <p>Click the Edit option button to modify your personal information.</p> <p></p> Parameters Can it be modified Email \u221a Phone \u221a DingTalk \u221a Lark \u221a Webhook \u221a"},{"location":"WhalealPlatform/12-Account/02-UserManagement/","title":"User Management","text":"<p>User management, WAP user management can configure account permissions, modify passwords, delete users, etc.</p>"},{"location":"WhalealPlatform/12-Account/02-UserManagement/#enter-the-user-management-page","title":"Enter the user management page","text":"<ol> <li>Click on the user name on the right</li> <li>Click Account</li> <li>Click User Management</li> </ol>"},{"location":"WhalealPlatform/12-Account/02-UserManagement/#manage-user-operations","title":"Manage User Operations","text":"<p>Click on the right side of the operation</p> <p></p> <p>Cancel Admin</p> <ul> <li>Configure administrator permissions for users so that administrators can delete users.</li> </ul> <p>Delete User</p> <ul> <li>Delete the current user</li> </ul> <p>Reset Password</p> <ul> <li>Reset password for user</li> </ul>"},{"location":"WhalealPlatform/12-Account/02-UserManagement/#configuring-user-permissions","title":"Configuring User Permissions","text":"<p>Click on the user name</p> <p></p> <p>Authority Management</p> <ul> <li>Create Server Permissions</li> </ul> <p>Configure permissions for users to create servers</p> <ul> <li>Create MongoDB Permissions</li> </ul> <p>Configure permissions for users to create mongodb</p> <p>Server</p> <ul> <li>You can view the server permissions managed by the current user</li> </ul> <p></p> <p>Mongo</p> <ul> <li>You can view the mongo permissions managed by the current user</li> </ul> <p></p>"},{"location":"WhalealPlatform/12-Account/03-AccountConfiguration/","title":"Account Configuration","text":"<p>Account configuration: users can configure whether the WAP account receives system alarm notifications. In addition, users can also set the time zone</p>"},{"location":"WhalealPlatform/12-Account/03-AccountConfiguration/#enter-the-user-configuration-page","title":"Enter the user configuration page","text":"<ol> <li>Click on the user name on the right</li> <li>Click Account</li> <li>Click Account Configuration</li> </ol> <p>Receive Alarm Notifications</p> <ul> <li>Choose whether to receive alert notifications</li> </ul> <p>Time Zone</p> <ul> <li>Users can configure the time zone and the time display of user monitoring data.</li> </ul>"},{"location":"WhalealPlatform/13-Setting/01-MongoDBPackge/","title":"MongoDB Package","text":"<p>Mongodb installation package management. To build Mongodb using the WAP platform, you need to manually upload the Mongodb media package on this page. Only when the corresponding version is uploaded can it be deployed.</p> <p></p>"},{"location":"WhalealPlatform/13-Setting/01-MongoDBPackge/#upload-installation-package-steps","title":"Upload installation package steps","text":"<ol> <li>Click Settings in the left navigation bar</li> <li>Click MongoDB Package</li> <li>Drag the file here or click Upload</li> </ol>"},{"location":"WhalealPlatform/13-Setting/01-MongoDBPackge/#deleting-the-installation-package","title":"Deleting the installation package","text":"<ol> <li>Click Settings in the left navigation bar</li> <li>Click MongoDB Package</li> <li>Select the installation package and click Delete</li> </ol>"},{"location":"WhalealPlatform/13-Setting/02-SMTP/","title":"Configure SMTP","text":"<p>Configure SMTP to send emails, which is used to send warning information of the WAP platform. Only after the server is configured can the warning emails be sent to users. The following describes how to configure SMTP in the environment</p>"},{"location":"WhalealPlatform/13-Setting/02-SMTP/#view-smtp-configuration","title":"View SMTP Configuration","text":"<ol> <li>Click on the left side of the setting</li> <li>Click SMTP</li> </ol> Parameters Description SMTP Server Address SMTP mail server address User Name username Password email Password Port The port number Email From Sender's Email Email Title mail title SSL Use SSL (encryption) Encode: Character encoding settings"},{"location":"WhalealPlatform/13-Setting/02-SMTP/#modify-smtp-steps","title":"Modify SMTP steps","text":"<p>1.Click Edit to edit the configuration</p> <p></p> <p>2.Configuring SMTP Parameters</p> Parameters Description SMTP Server Address <code>smtp.example.com</code> -Replace with your SMTP server address. User Name <code>wap</code> - Replace with your username. Password <code>password</code> - Replace with your email password. Port <code>465</code> - Replace with your SMTP port number. Email From <code>email@example.com</code> - Replace with your sender's email address. Email Title <code>alert</code> - Replace with the title of your message. SSL <code>Enable</code> - Use SSL, the default is Enable. Encode <code>UTF-8</code>- Character encoding type, the default is UTF-8. <p>3.Click Seve</p>"},{"location":"WhalealPlatform/13-Setting/03-CollectionGranularity/","title":"Collection Granularity","text":"<p>The collection granularity configuration can set the frequency of data collection in monitoring, modify the collection granularity configuration, and modify the granularity configuration of the host and MongoDB, as well as the retention time of MongoDB node logs.</p>"},{"location":"WhalealPlatform/13-Setting/03-CollectionGranularity/#view-collection-granularity-configuration","title":"View  Collection Granularity Configuration","text":"<ol> <li>Click Settings in the left navigation bar</li> <li>Click Collection Granularity</li> </ol>"},{"location":"WhalealPlatform/13-Setting/03-CollectionGranularity/#parameter-introduction","title":"Parameter Introduction","text":"Parameters Description Host Monitor Collection Granularity The frequency and level of detail with which metrics are collected and stored from monitored hosts. It determines how often metrics such as CPU usage, memory usage, disk I/O, and network traffic are sampled and recorded. MONGODB Monitor Collection Granularity The frequency at which monitoring metrics are collected from the monitored MongoDB cluster. MONGODB Node Analysis Log Retention Time Select the retention time of mongodb analysis log will be deleted after expiration MONGODB Node Raw Log Retention Time MONGODB Node Raw Log Retention Time will be deleted after it expires"},{"location":"WhalealPlatform/13-Setting/04-Kubernetes/","title":"Configure Kubernetes","text":"<p>Configure Kubernetes for the WAP platform. Add Kubernetes to create hosts and mongodb using Kubernetes.</p>"},{"location":"WhalealPlatform/13-Setting/04-Kubernetes/#view-kubernetes-configuration","title":"View Kubernetes Configuration","text":"<ol> <li>Click on the left side of the setting</li> <li>Click Kubernetes</li> </ol>"},{"location":"WhalealPlatform/13-Setting/04-Kubernetes/#add-kubernetes-configuration-steps","title":"Add Kubernetes configuration steps","text":"<ol> <li>Click ADD K8S</li> </ol> <p>Name: Configure k8s name</p> <p>Type: Support for Linode Kubernetes and Amazon EKS</p> <p>Configuration: k8s Configuration configuration file is used to connect to EKS</p> <ol> <li>Click Confirm</li> </ol>"},{"location":"WhalealPlatform/13-Setting/04-Kubernetes/#example-configuring-kubernetes","title":"Example: Configuring Kubernetes","text":"<ol> <li>You need to prepare the Kubernetes confing file in advance. The following is an example of Kubernetes confing</li> </ol> <p>```    apiVersion: v1    kind: Config    preferences: {}</p> <p>clusters:    - cluster:        certificate-authority-data:         server: https://:443      name: lke196921 <p>users:    - name: lke196921-admin      user:        as-user-extra: {}        token:  <p>contexts:    - context:        cluster: lke196921        namespace: default        user: lke196921-admin      name: lke196921-ctx</p> <p>current-context: lke196921-ctx    ```</p> <ol> <li> <p>Configure kubernetes fill in</p> </li> <li> <p>name: Enter the kubernetes cluster name</p> </li> <li> <p>Type: Choose Kubernetes</p> </li> <li>Configuration: Copy the Kubeconfig file here</li> </ol> <p></p> <ol> <li>Click confirm Configuration Complete</li> </ol> <p></p>"},{"location":"WhalealPlatform/13-Setting/05-S3/","title":"Configure S3","text":"<p>Configure s3 storage for WAP. Some functions in WAP require s3 configuration to use, such as Support and Diagnose-LogVis. Here is how to configure s3 in the environment</p>"},{"location":"WhalealPlatform/13-Setting/05-S3/#view-s3-configuration","title":"View s3 Configuration","text":"<ol> <li>Click on the left side of the setting</li> <li>Click S3</li> </ol>"},{"location":"WhalealPlatform/13-Setting/05-S3/#parameter-introduction","title":"Parameter Introduction","text":"Parameters Description Cloud Bucket Bucket Name Path Prefix Path name, default is wap Credential ID Access Key ID, used to identify you Credential Key The Secret Access Key that is paired with the Access Key ID Endpoint The endpoint URL of the object storage"},{"location":"WhalealPlatform/14-Support/01-ClusterInspection/","title":"Cluster inspection","text":"<p>In addition to the basic problem troubleshooting tools built into the platform, Whaleal also provides services from professional technicians. It can collect MongoDB node and cluster information through inspection scripts, and provide the collected data to our technicians for professional problem analysis, problem troubleshooting, and provide professional rectification suggestions and prevention plans.</p>"},{"location":"WhalealPlatform/14-Support/01-ClusterInspection/#diagnostic-information-collection","title":"Diagnostic information collection","text":"<ol> <li>Select menu Support</li> <li>Select the cluster to inspect from the drop-down menu</li> <li>Click Mdiag to start collecting information</li> </ol> <p>After the information collection is completed, the collection record will be displayed on the current page. Users can download the collected information locally by clicking the Download button. You can directly send the downloaded package to our technicians for problem analysis and problem diagnosis. Or you can seek help from our technical staff in the form of submitting a work order by clicking Submit Case.</p>"},{"location":"WhalealPlatform/14-Support/02-Case/","title":"Case","text":""},{"location":"WhalealPlatform/14-Support/02-Case/#the-agentgz-package-has-a-problem-and-cannot-be-downloaded","title":"The agent.gz package has a problem and cannot be downloaded.","text":"<p>Server-web did not start properly.</p>"},{"location":"WhalealPlatform/14-Support/02-Case/#the-new-version-of-the-configuration-file-is-named-after-the-port-and-the-previous-one-is-in-the-form-of-ipport-do-you-need-to-manually-modify-the-configuration-file-name-of-the-old-cluster","title":"The new version of the configuration file is named after the port, and the previous one is in the form of ip+port. Do you need to manually modify the configuration file name of the old cluster?","text":"<p>The old cluster does not need to be modified and will not be affected.</p>"},{"location":"WhalealPlatform/14-Support/02-Case/#monitoring-indicator-cpuinfo_id-this-corresponds-to-user-cpu","title":"Monitoring indicator = 'cpuInfo_id' this corresponds to: user cpu?","text":"<p>No, Id stands for cpu idle rate.</p>"},{"location":"WhalealPlatform/14-Support/02-Case/#more-than-60-in-60-seconds-will-the-alarm-be-triggered-10-times-but-this-value-is-not-more-than-40-at-present-but-it-has-been-reported-all-the-time","title":"More than 60% in 60 seconds, will the alarm be triggered 10 times, but this value is not more than 40% at present, but it has been reported all the time.","text":"<p>Within 60s, if the cpu utilization rate is greater than 60% and occurs ten times, the alarm will be triggered. Once the alarm message is sent every 10 minutes, the alarm message will be sent with a granularity of 1 minute. In this case, the average cpu utilization rate within one minute is 40%. Click real-time to see the cpu information at the seconds level.</p>"},{"location":"WhalealPlatform/14-Support/02-Case/#use-the-latest-version-of-prometheus-to-collect-datagram-errors-whether-it-is-related-to-the-version-relationship-ts2024-04-08t035134306z-callerrefreshgo90-levelerror-component-discovery-manager-scrape-discoveryhttp-configwap-monitor-msg-unable-to-refresh-target-groups-err-invalid-character-wlooking-for-beginning-of-value","title":"Use the latest version of prometheus to collect Datagram errors. Whether it is related to the version relationship ts=2024-04-08T03:51:34.306Z caller=refresh.go:90 level=error component= \"\" discovery manager scrape \"\" discovery=http config=wap-monitor msg= \"\" Unable to refresh target groups \"\" err= \"\" invalid character 'W'looking for beginning of value \"\"","text":"<p>The prometheus configuration file tries this approach.</p> <pre><code>job_name: wap-monitor\nscrape_interval: 10s\nmetrics_path: '/api/server/mongo/getMongoDBForPrometheus'\nparams:\n  id: [\"public\"]\n  type: [\"project\"]\nbasic_auth:\n  username: 'admin'\n  password: xxxxx\nstatic_configs:\n\n  - targets: ['172.xx.xx.xx:8080']\n    labels:\n      instance: wap\n</code></pre>"},{"location":"WhalealPlatform/14-Support/02-Case/#at-present-after-the-monitoring-is-turned-on-is-the-frequency-of-monitoring-once-per-second-can-you-define-the-time-frequency-by-yourself","title":"At present, after the monitoring is turned on, is the frequency of monitoring once per second? can you define the time frequency by yourself?","text":"<p>You can adjust it yourself and monitor the granularity in setting.</p>"},{"location":"WhalealPlatform/14-Support/02-Case/#the-whaleal-mongodb-log-file-is-so-large-that-the-disk-is-full-and-the-mongo-service-cannot-be-started-wont-he-clean-it-up-himself-do-you-have-to-clean-it-manually-every-time","title":"The whaleal-mongodb-log file is so large that the disk is full and the mongo service cannot be started. Won't he clean it up himself? Do you have to clean it manually every time?","text":"<p>What is saved in whaleal-mongodb-log can be cleared from the logs of mongoDB nodes. By default, save for one month. Configure the saving time of mongodb logs in the setting page.</p>"},{"location":"WhalealPlatform/14-Support/02-Case/#in-the-logic-of-deploying-mongo-is-there-a-default-log-level-of-3-frequent-mongolog-refresh-is-there-any-relationship-between-opening-monitoring-and-enabling-log-monitoring-in-the-platform","title":"In the logic of deploying mongo, is there a default log level of 3, frequent mongo.log refresh, is there any relationship between opening monitoring and enabling log monitoring in the platform?","text":"<p>It's a cpython connection. Our agent doesn't involve Python stuff.</p>"},{"location":"WhalealPlatform/14-Support/02-Case/#the-monitoring-information-cannot-be-viewed-the-mongo-log-has-just-been-cut-by-the-hour-does-this-matter","title":"The monitoring information cannot be viewed. The mongo log has just been cut by the hour. Does this matter?","text":"<p>The MongoDB log has nothing to do with this. This general situation is caused by the network. Delete all the host alarm policies configured on this host and see if there is any monitoring data.</p>"},{"location":"WhalealPlatform/14-Support/02-Case/#prometheus-configures-multiple-project-gathering-to-report-an-error","title":"Prometheus configures multiple project gathering to report an error.","text":"<p>Only one project can be configured at a time.</p>"},{"location":"WhalealPlatform/14-Support/02-Case/#after-using-the-cluster-rename-only-the-cluster-display-has-changed-and-the-name-of-the-replica-set-of-the-cluster-will-not-change-will-it","title":"After using the cluster rename, only the cluster display has changed, and the name of the replica set of the cluster will not change, will it?","text":"<p>The cluster name will not change.</p>"},{"location":"WhalealPlatform/14-Support/02-Case/#what-data-is-stored-in-nacos-will-the-loss-of-the-data-catalog-affect-the-service","title":"What data is stored in Nacos? Will the loss of the data catalog affect the service?","text":"<p>Store the routing information of the java service. Nacos does not save data and can be rebuilt.</p>"},{"location":"WhalealPlatform/14-Support/02-Case/#when-backing-up-the-ddt-host-randomly-selects-which-node-to-back-up-from-is-it-possible-for-him-to-choose-the-hidden-node-if-he-selects-the-slave-node-will-the-cpu-be-very-high","title":"When backing up, the DDT host randomly selects which node to back up from. Is it possible for him to choose the hidden node? If he selects the slave node, will the cpu be very high?","text":"<p>DDT is a server used to perform backup tasks. It is completed by executing the JAVA backup process. Try not to place this on the server where MongoDB is located. Try to add an extra server to do backup. The backup operation does not consume much CPU on the source side, which is equivalent to performing a query operation. There will be a little stress during the first full backup.</p>"},{"location":"WhalealPlatform/14-Support/02-Case/#there-is-a-problem-with-backup-configuration-s3","title":"There is a problem with backup configuration S3","text":"<p>If the bucket name is filled in incorrectly, create a backup policy and refresh the page according to the new configuration. After this key is triggered once, the backend will re-encrypt the key, so there is a problem with the connection, so you need to re-enter key accesskey.</p>"},{"location":"WhalealPlatform/14-Support/02-Case/#after-the-agent-server-is-restarted-you-need-to-start-the-agent-process-manually","title":"After the agent server is restarted, you need to start the agent process manually","text":"<p>Use the agent script to configure agent to serve the system and set up boot self-boot.</p>"},{"location":"WhalealPlatform/14-Support/02-Case/#when-converting-from-a-replica-architecture-to-a-fragmented-architecture-all-of-them-are-on-the-same-group-of-machines-in-the-form-of-multiple-instances-when-converting-to-a-fragmented-architecture-will-it-be-different-when-allocating-memory-if-not-will-it-simply-oom-when-allocating-memory-he-wont-know-whether-it-is-multiple-instances-or-50-of-physical-memory","title":"When converting from a replica architecture to a fragmented architecture, all of them are on the same group of machines (in the form of multiple instances). When converting to a fragmented architecture, will it be different when allocating memory? If not, will it simply oom? When allocating memory, he won't know whether it is multiple instances or 50% of physical memory?","text":"<p>When the amount of data is large, it will oom. If not set by default in platform, MongoDB defaults to 50% of the physical memory.</p>"},{"location":"WhalealPlatform/14-Support/02-Case/#after-the-backup-strategy-is-created-when-is-its-trigger-time-this-can-be-seen-there","title":"After the backup strategy is created, when is its trigger time? this can be seen there.","text":"<p>After the first creation, you can go to the source MongoDB event group to check the progress.</p>"},{"location":"WhalealPlatform/14-Support/02-Case/#what-configuration-is-recommended-for-ddt-hosts","title":"What configuration is recommended for DDT hosts?","text":"<p>DDT recommends high CPU, 8C+ 16GB+</p>"},{"location":"WhalealPlatform/14-Support/02-Case/#what-is-the-ddt-backup-logic-like","title":"What is the DDT backup logic like?","text":"<p>This is how DDT works in real time: https://docs.whaleal.com/guide/en/documentDataTransfer/Introduction/Architecture.html.</p>"},{"location":"WhalealPlatform/14-Support/02-Case/#will-the-process-above-ddt-be-retained-all-the-time-so-that-if-there-are-more-instances-there-will-be-many-such-process-on-ddt-machines","title":"Will the process above DDT be retained all the time, so that if there are more instances, there will be many such process on ddt machines?","text":"<p>There are two processes during a DDT backup. After the full backup is completed, the full DDT process exits, leaving a DDT process that synchronizes the oplog synchronized in real time.</p>"},{"location":"WhalealPlatform/14-Support/02-Case/#if-there-is-a-ddt-host-to-configure-backup-tasks-is-there-a-place-to-configure-the-time-to-avoid-time-conflicts","title":"If there is a ddt host to configure backup tasks, is there a place to configure the time to avoid time conflicts.","text":"<p>Currently, custom times are not supported, but if you want to achieve the effect of avoiding time conflicts, different MongoDB clusters can also be created at different times when the backup policy is first configured.</p>"},{"location":"WhalealPlatform/14-Support/02-Case/#there-is-a-problem-with-ddt-backup-cannot-allocate-memory-errno12","title":"There is a problem with ddt backup  \"Cannot allocate memory (errno=12)\"","text":"<p>All DDT processes died, DDT died due to insufficient memory.</p>"},{"location":"WhalealPlatform/14-Support/02-Case/#use-wap-marketplace-to-start-platform-services-through-mirroring-but-the-service-process-did-not-start-successfully-do-i-still-need-to-deploy-it-manually","title":"Use WAP marketplace to start platform services through mirroring, but the service process did not start successfully? Do I still need to deploy it manually?","text":"<p>The EC2 server cannot connect to the external network, causing the script not to run</p>"},{"location":"WhalealPlatform/14-Support/02-Case/#how-did-the-machines-in-server-be-added-to-project-no-machines-can-be-added-to-the-project-now-after-clicking-on-the-project-on-the-platform-they-are-all-empty","title":"How did the machines in server be added to project? no machines can be added to the project now. After clicking on the project on the platform, they are all empty.","text":"<p>All the newly added hosts are on public. 1. Configuration file \"parameters.properties\" in / opt/agent after the agent instance is started Write foreign_url= parameters in the format foreign_url= http://54.175.147.38:8080 2. Execute the command after configuration to check whether the process starts \"systemctl status whaleal_agent\" Wait about 30 seconds after startup 3. All launched agent hosts will be in public project by default. You can create a new Project, remove the hosts from the public and put them in the new public. 4. You can create a MongoDB cluster based on Project</p>"},{"location":"WhalealPlatform/14-Support/02-Case/#the-ddt-machine-used-for-synchronization-does-not-have-agent-this-does-not-affect-data-synchronization-can-i-just-configure-mong-on-it","title":"The ddt machine used for synchronization does not have agent. This does not affect data synchronization, can I just configure mong on it?","text":"<p>If you don't use backup features on the platform, there will be no impact.</p>"},{"location":"WhalealPlatform/14-Support/02-Case/#do-you-want-to-write-all-the-sourcedsurl-addresses-configured-by-ddt-or-just-write-the-main-node","title":"Do you want to write all the sourceDsUrl addresses configured by DDT, or just write the main node?","text":"<p>Both are fine. Master node, slave node, and cluster URI are all available, or only slave nodes can be configured to relieve the pressure on the master node</p>"},{"location":"WhalealPlatform/14-Support/02-Case/#backup-issuin-configuration","title":"Backup issu\uff0cIn configuration:","text":"<ol> <li>Full volume and real-time</li> <li>Full volume and increment Do these two mean the same? I want to synchronize all the data now. After the synchronization of all the data is completed, I need to continue to synchronize incremental data. Which configuration should I use? Full and real-time: full oplog (full start time to positive infinite time) Full and incremental: full oplog (full start time to full end time)</li> </ol>"},{"location":"WhalealPlatform/14-Support/02-Case/#after-mongodb-was-separated-from-the-platform-the-mongo-process-on-the-host-also-stopped-do-you-need-other-pre-work-to-deploy-mongodb-again-with-this-machine","title":"After mongoDB was separated from the platform, the mongo process on the host also stopped. Do you need other pre-work to deploy MongoDB again with this machine?","text":"<p>Start the MongoDB service, and the data directory is different from the previous data directory.</p>"},{"location":"WhalealPlatform/14-Support/02-Case/#the-ddt-server-used-for-data-synchronization-does-not-have-an-agent-installed-will-it-affect-data-synchronization-can-i-directly-deploy-and-configure-mongodb-if-i-need-to-use-the-backup-function-later-how-should-i-restore-it-to-the-original-ddt","title":"The DDT server used for data synchronization does not have an Agent installed. Will it affect data synchronization? Can I directly deploy and configure MongoDB? If I need to use the backup function later, how should I restore it to the original DDT?","text":"<p>Does not affect data synchronization. If the DDT server is subscribed by marketplace's agent DDT machine clears data, services Start the agent of the ddt machine and put it in the Project called DDT Just start the backup normally. If the DDT server is not created by subscription, you cannot use the backup function in wap.</p>"},{"location":"WhalealPlatform/14-Support/02-Case/#ddt-has-an-error-i-configured-ddt-yesterday-ran-for-a-while-then-stopped-ran-again-today-and-started-in-the-following-order-start-ddtsh-start-moitorsh","title":"DDT has an error. I configured ddt yesterday, ran for a while, then stopped, ran again today, and started in the following order: start-DDT.sh start-moitor.sh","text":"<p>If you see the log error report, it should be started repeatedly [tool for monitoring DDT synchronization] DDT has two processes:</p> <ol> <li>DDT synchronization MongoDB data tool</li> <li>tools for monitoring DDT synchronization (this tool uses web and spring JAR)</li> </ol> <p>If you execute start-all.sh, you will start both processes. If you execute start-DDT.sh, only start the DDT synchronization data tool</p>"},{"location":"WhalealPlatform/14-Support/02-Case/#data-check-ddt-synchronization-data-destination-is-missing","title":"Data check. DDT synchronization data destination is missing.","text":"<p>If the table is a dynamic table (operating in real time) There will be data inconsistencies, and dynamic tables can be checked many times to determine data consistency. Db.ns.count is a fuzzy calculation, sometimes because of cache and other problems, the amount of data may not be correct. Can be used on the target side: use the exact count to view the number of library table documents db.ns.countDocuments ({})</p>"},{"location":"WhalealPlatform/14-Support/02-Case/#deploy-another-cluster-and-copy-a-ddt-directory-you-can-run-both-of-them-for-example-project-a-is-synchronized-now-project-b-needs-to-be-migrated-and-start-two-ddt-at-the-same-time","title":"Deploy another cluster and copy a ddt directory. You can run both of them. For example, project a is synchronized. Now project b needs to be migrated, and start two ddt at the same time.","text":"<p>DDT startup script needs to be modified. It is not supported by default. The second DDT must be in a new directory Then you can start run: </p> <pre><code>nohup java-Xmx$max_heap_size-jar ../execute-1.0-SNAPSHOT.jar ../config/DDT.properties &gt; /dev/null 2 &gt; &amp;1 &amp; \n</code></pre>"},{"location":"WhalealPlatform/14-Support/02-Case/#help-me-confirm-that-ddt-is-synchronizing-data-in-real-time-if-we-want-to-switch-the-connection-to-a-new-cluster-can-we-replace-it-directly-or-do-we-have-to-disconnect-ddt-synchronization-first-stop-business-stop-ddt-and-finally-replace-the-connection-url","title":"Help me confirm that DDT is synchronizing data in real time. If we want to switch the connection to a new cluster, can we replace it directly, or do we have to disconnect DDT synchronization first, stop business, stop DDT, and finally replace the connection URL?","text":"<p>Stop the business first, then stop the DDT service, and then replace the connection URL. This is the recommended action step and needs to be operated within the shutdown maintenance window.</p>"},{"location":"WhalealPlatform/14-Support/02-Case/#if-both-the-source-and-target-sides-of-ddt-synchronization-have-write-operations-will-ddt-synchronization-have-an-impact","title":"If both the source and target sides of DDT synchronization have write operations, will DDT synchronization have an impact?","text":"<p>In this way, the data on the source side and the destination side will be inconsistent.</p>"},{"location":"WhalealPlatform/15-AdministerWhaleal/01-StartAndStopWhalealApplication/","title":"Start and Stop Whaleal Application","text":"<p>Whaleal Application is split into separate services to run, and all services are independent of each other.</p>"},{"location":"WhalealPlatform/15-AdministerWhaleal/01-StartAndStopWhalealApplication/#start-whaleal","title":"Start Whaleal","text":"<pre><code>cd /opt/WAP/\nsh start.sh\n</code></pre>"},{"location":"WhalealPlatform/15-AdministerWhaleal/01-StartAndStopWhalealApplication/#stop-whaleal","title":"Stop Whaleal","text":"<pre><code>cd /opt/WAP/\nsh stop.sh\n</code></pre>"},{"location":"WhalealPlatform/16-Troubleshooting/01-EC2andK8S/","title":"EC2andK8S","text":"<p>Problems that occur when adding ec2 or k8s. The following tasks are used to check for common and easy-to-fix problems:</p>"},{"location":"WhalealPlatform/16-Troubleshooting/01-EC2andK8S/#check-the-agent-log","title":"Check the agent log","text":"<p>If you encounter problems when adding ec2 or k8s hosts, please check the Agent output log for errors.</p> <p>The log file is stored in the server \"/logs/whaleal_agent-collection_log\" file</p>"},{"location":"WhalealPlatform/16-Troubleshooting/01-EC2andK8S/#check-whether-the-agent-is-started-normally","title":"Check whether the agent is started normally","text":"<p>Make sure the agent process is running</p> <p>Run the following command to view the agent status:</p> <pre><code>&gt; systemctl status whaleal_agent\n\n\u25cf whaleal_agent.service - Start Whaleal Platform Agent Service\n   Loaded: loaded (/etc/systemd/system/whaleal_agent.service; enabled; vendor preset: disabled)\n   Active: active (running) since \u4e00 2024-07-01 05:46:14 UTC; 1h 12min ago\n Main PID: 7879 (java)\n   CGroup: /system.slice/whaleal_agent.service\n           \u251c\u2500 7879 java -jar /opt/agent/agent-collection-1.0.0.jar --foreign.url=http://xx.xx.xx.xx:8080 --agentId=system --podType=\n</code></pre>"},{"location":"WhalealPlatform/16-Troubleshooting/01-EC2andK8S/#check-whether-the-agent-and-server-are-connected","title":"Check whether the agent and server are connected","text":"<p>Please check whether the WAP service is running normally and confirm that the server connection is normal. Verify whether the Agent can connect to the WAP server through TCP port 9619.</p>"},{"location":"WhalealPlatform/16-Troubleshooting/02-MongoDBMonitoring/","title":"MongoDBMonitoring","text":""},{"location":"WhalealPlatform/16-Troubleshooting/02-MongoDBMonitoring/#monitoring-issues","title":"Monitoring issues","text":""},{"location":"WhalealPlatform/16-Troubleshooting/02-MongoDBMonitoring/#check-whether-the-agent-is-started-normally","title":"Check whether the agent is started normally","text":"<p>Make sure the agent process is running</p> <p>Run the following command to view the agent status:</p> <pre><code>&gt; systemctl status whaleal_agent\n\n\u25cf whaleal_agent.service - Start Whaleal Platform Agent Service\n   Loaded: loaded (/etc/systemd/system/whaleal_agent.service; enabled; vendor preset: disabled)\n   Active: active (running) since \u4e00 2024-07-01 05:46:14 UTC; 1h 12min ago\n Main PID: 7879 (java)\n   CGroup: /system.slice/whaleal_agent.service\n           \u251c\u2500 7879 java -jar /opt/agent/agent-collection-1.0.0.jar --foreign.url=http://xx.xx.xx.xx:8080 --agentId=system --podType=\n</code></pre>"},{"location":"WhalealPlatform/16-Troubleshooting/02-MongoDBMonitoring/#connection-issues","title":"Connection Issues","text":"<p>Verify that MongoDB is running and accessible.</p> <p>Use the telnet command to check whether the necessary port 9619 is open.</p> <p>Make sure the necessary ports are open.</p>"},{"location":"WhalealPlatform/16-Troubleshooting/02-MongoDBMonitoring/#system-resource","title":"system resource","text":"<p>Ensure that the system running MongoDB and Agent has sufficient resources.</p> <p>Monitor system resource usage (CPU, memory, disk I/O) to see if it has reached full capacity</p>"},{"location":"WhalealPlatform/16-Troubleshooting/02-MongoDBMonitoring/#check-the-agent-log","title":"Check the agent log","text":"<p>If you encounter problems when adding ec2 or k8s hosts, please check the Agent output log for errors.</p> <p>The log file is stored in the server \"/logs/whaleal_agent-collection_log\" file</p>"},{"location":"WhalealPlatform/16-Troubleshooting/03-MongoDBUpgradeDowngrade/","title":"MongoDBUpgradeDowngrade","text":""},{"location":"WhalealPlatform/16-Troubleshooting/03-MongoDBUpgradeDowngrade/#check-version-compatibility","title":"Check version compatibility","text":"<p>When upgrading, make sure the target version is higher than the current version. Similarly, when downgrading, make sure the target version is lower than the current version.</p> <p>Version upgrades and downgrades cannot be performed across versions, and can only be performed between adjacent versions. (For example, you cannot upgrade version 4.2 to 5.0 directly, but you can upgrade 4.2 to 4.4 and then 4.4 to 5.0. Similarly, you cannot downgrade 5.0 to 4.2 directly, but you can downgrade 5.0 to 4.4 and then 4.4 to 4.2.)</p>"},{"location":"WhalealPlatform/16-Troubleshooting/03-MongoDBUpgradeDowngrade/#check-the-logs","title":"Check the logs","text":"<p>Check the MongoDB log (mongod.log) for any errors.</p> <p>View WAP event group log error information</p>"},{"location":"WhalealPlatform/16-Troubleshooting/03-MongoDBUpgradeDowngrade/#backing-up-your-data","title":"Backing up your data","text":"<p>Choose to back up data before upgrading or downgrading. If the upgrade or downgrading fails, you can choose to restore the mongodb data by backing up the snapshot.</p>"},{"location":"WhalealPlatform/16-Troubleshooting/03-MongoDBUpgradeDowngrade/#notify-the-whaleal-team","title":"Notify the Whaleal Team","text":"<p>Provide the whale team with information about the problems encountered during the upgrade and downgrade process.</p> <p>When upgrading, make sure the target version is higher than the current version. Similarly, when downgrading, make sure the target version is lower than the current version.</p>"},{"location":"WhalealPlatform/16-Troubleshooting/04-BackupandRestore/","title":"BackupandRestore","text":""},{"location":"WhalealPlatform/16-Troubleshooting/04-BackupandRestore/#backup","title":"Backup","text":""},{"location":"WhalealPlatform/16-Troubleshooting/04-BackupandRestore/#unable-to-start-backup","title":"Unable to start backup","text":"<p>Check that the s3 link is configured correctly and has the appropriate permissions</p> <p>View WAP event group log error information</p> <p>Check the MongoDB log (mongod.log) for any errors related to the backup process.</p>"},{"location":"WhalealPlatform/16-Troubleshooting/04-BackupandRestore/#storage-issues","title":"Storage issues","text":"<p>If the backup file is too large, check whether there is free storage space.</p>"},{"location":"WhalealPlatform/16-Troubleshooting/04-BackupandRestore/#backup-performance","title":"Backup performance","text":"<p>A slow backup process can be caused by disk I/O problems or high server load. Check server performance indicators during the backup process.</p>"},{"location":"WhalealPlatform/16-Troubleshooting/04-BackupandRestore/#restore","title":"Restore","text":""},{"location":"WhalealPlatform/16-Troubleshooting/04-BackupandRestore/#version-compatibility","title":"Version compatibility","text":"<p>Make sure that the target MongoDB server to be restored and the backup server have the same version. Backup files between different versions may be incompatible, resulting in recovery failure or incomplete data.</p>"},{"location":"WhalealPlatform/16-Troubleshooting/04-BackupandRestore/#storage-issues_1","title":"Storage issues","text":"<p>If the backup file is too large, check whether there is free storage space.</p>"},{"location":"WhalealPlatform/17-FrequentlyAskedQuestions/01-FrequentlyAskedQuestions/","title":"Frequently Asked Questions","text":"<p>This page contains answers to frequently asked questions about WAP.</p> <ol> <li>Can I reset my password?</li> </ol> <p>The password can be reset, but only users with admin privileges can perform this operation</p> <ol> <li>Can the host under a project be moved to another project? </li> </ol> <p>Yes, you need to move it out of the old project before moving it to another project.</p> <ol> <li>What types of deployment can I create in WAP?</li> </ol> <p>Using WAP, you can configure all MongoDB deployment types: sharded clusters, replica sets, and standalones.</p> <ol> <li>Is the monitoring frequency once per second? Can I define the time frequency myself?</li> </ol> <p>You can adjust it yourself, in the settings, monitor the granularity.</p> <ol> <li>After configuring the alert rules, how can I receive the alert information?</li> </ol> <p>When the alert condition is configured and the alert is triggered, the alert information can be notified via email, DingTalk, SMS, etc.</p> <ol> <li>What MongoDB versions does WAP support?</li> </ol> <p>WAP supports 98% of MongoDB on the market, and supports versions 5.0 to 7.0.</p> <ol> <li>Does WAP support changes to the MongoDB cluster architecture?</li> </ol> <p>Currently supported mongodb architecture changes include single-machine conversion to replica set, replica set conversion to sharding</p> <ol> <li>What MongoDB authentication methods are supported?</li> </ol> <p>Currently supported authentication methods include account and password, account and password and CA certificate</p> <ol> <li>After the agent server is restarted, do you need to manually start the agent process?</li> </ol> <p>The agent startup script will configure the agent as a system service and set it to start automatically at boot</p> <ol> <li> <p>Is the node shut down when it leaves the management?</p> <p>When a cluster is removed from management, it is not managed or displayed on the platform, but is not shut down on the host. Deleting a node means shutting down the node.</p> </li> <li> <p>How to receive alerts after configuring them?</p> <p>When the start is triggered after the start conditions are configured, the start information will be notified via email, DingTalk, SMS, etc.</p> </li> <li> <p>Does mongo support synchronization?</p> <p>Support, you can use the backup and restore function to synchronize data</p> </li> <li> <p>What is the principle of horizontal expansion of WAP platform?</p> <p>Horizontal expansion is to build multiple WAP services. The Agents managed by the same appdb can be hashed and assigned to different WAP services to reduce the pressure on a single WAP. When a WAP service fails, other WAP services are not affected. The affected agents will be re-hashed and assigned to healthy WAP services.</p> </li> <li> <p>How long will the oplog be stored?</p> <p>Depends on the number of recovery days configured by the user, with a maximum retention period of half a year and a minimum retention period of one day</p> </li> <li> <p>Can the Home page be searched and displayed based on the cluster name?</p> <p>The home page does not allow you to select a cluster for display. You can only view monitoring information for a specific cluster on the MongoDB page.</p> </li> </ol>"},{"location":"WhalealPlatform/18-ReleaseNotes/01-WhalealChangelog/","title":"Whaleal Changelog","text":""},{"location":"WhalealPlatform/18-ReleaseNotes/01-WhalealChangelog/#whaleal-300","title":"Whaleal 3.0.0","text":"<ul> <li>Add backup function to support sharding cluster backup</li> <li>Support online upgrades</li> <li>Support host quotas</li> <li>Add data query functions</li> <li>Optimization of mongodb log collection</li> <li>Internationalization is all revised to English</li> <li>Optimize alarm module</li> <li>Add multiple alarm channels</li> </ul>"},{"location":"WhalealPlatform/18-ReleaseNotes/01-WhalealChangelog/#whaleal-200","title":"Whaleal 2.0.0","text":"<ul> <li>Remove redundant files, and optimize agent execution.</li> <li>Clustering: Standardize cluster display and creation, check whether ports are occupied before creation, add creation index function, add cluster operation lock events, add project concepts, and divide host cluster members. Add read-write preferences, add explanation and aggregation.</li> <li>Monitoring: Supplementary monitoring indicators, quantify and optimize the display on the front page, and increase the comparison of various indicators.</li> <li>Log: Event operations exit abnormally, add event status and waiting information, add operation event group logs, add alarm information to archive</li> <li>Diagnosis: Add a new diagnosis function to diagnose a cluster or a node, and the diagnosis content is displayed in batches by date. Inspection can be carried out for a certain batch and the inspection results can be compared with constant values. It also supports downloading diagnostic logs and executing inspection functions regularly.</li> <li>Settings: A new setting module has been added, including MongoDB compressed package management, email settings that can accept alarm information from the host or cluster, and collection granularity configuration that can set the log retention time, the host and mongo collect granularity, and the interval between regular inspections.</li> <li>Account: Add administrator role rights management, which can increase or decrease user rights. User rights determine whether certain content of the user is visible and operable. Administrators can delete the user or directly reset the user password.</li> <li>Notification: Move the notification to the sidebar to filter and observe the message information.</li> </ul>"},{"location":"WhalealPlatform/18-ReleaseNotes/01-WhalealChangelog/#whaleal-100","title":"Whaleal 1.0.0","text":"<ul> <li>Support account/email/mobile number login.</li> <li>The password can be changed using the Captcha.</li> <li>Display host and MongoDB statistics.</li> <li>Host list Host statistics Visual display of host status.</li> <li>Add a host and manage a new host according to the operating instructions.</li> <li>Check the host situation: basic information, monitoring, logs, commands, alarms.</li> <li>MONGO list MONGO cluster information View the MONGODB cluster status: node information, events, cluster logs, and operations.</li> <li>MONGO cluster operation new creation, management, upgrading, master-slave switching, single instance conversion to replication set, turning on/off authentication, monitoring information, node log</li> <li>Reset account information and password.</li> </ul>"},{"location":"whalealJMC/","title":"Whaleal JMC","text":"<p>whaleal</p>"}]}